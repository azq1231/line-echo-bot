const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddManualUserModal-D967k0HM.js","assets/runtime-dom.esm-bundler-wIgYT9iR.js","assets/ReplyContentModal-CRfWvUgy.js"])))=>i.map(i=>d[i]);
import{r as g,c as B,o as Kt,a as Qt,b as l,d as i,e as a,f as m,g as kt,h as Xt,t as p,n as T,F as U,i as A,j as $t,w as c,k as Ct,v as St,u as Et,l as Ut,m as Yt}from"./runtime-dom.esm-bundler-wIgYT9iR.js";import{a as M}from"./index-R-lXtGyY.js";const Dt="modulepreload",te=function(X){return"/static/"+X},Ot={},At=function(Y,I,S){let R=Promise.resolve();if(I&&I.length>0){let C=function($){return Promise.all($.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),_=y?.nonce||y?.getAttribute("nonce");R=C(I.map($=>{if($=te($),$ in Ot)return;Ot[$]=!0;const x=$.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${$}"]${b}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":Dt,x||(E.as="script"),E.crossOrigin="",E.href=$,_&&E.setAttribute("nonce",_),document.head.appendChild(E),x)return new Promise((L,N)=>{E.addEventListener("load",L),E.addEventListener("error",()=>N(new Error(`Unable to preload CSS for ${$}`)))})}))}function f(y){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=y,window.dispatchEvent(_),!_.defaultPrevented)throw y}return R.then(y=>{for(const _ of y||[])_.status==="rejected"&&f(_.reason);return Y().catch(f)})},ee={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},se={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},ne={class:"tw-text-center tw-mb-4"},oe={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},re={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},le=["disabled"],ie={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},ae={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},ue={class:"tw-text-base tw-font-bold"},we={class:"tw-text-sm tw-opacity-90"},de={class:"tw-flex-grow tw-space-y-1"},ce={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},fe={class:"tw-mb-2"},pe={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},ve=["onDragover","onDragleave","onDrop"],ge=["onClick","title"],_e={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},me={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},ye=["title","onClick"],he=["onClick"],xe={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},be={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},ke={class:"tw-max-h-48 tw-overflow-y-auto"},$e={key:0},Ce={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Se={key:1},Ee=["onClick"],Ue=["onClick"],Oe={key:1},Ae={key:0},Me=["onClick"],Te=["onClick"],Re=["onClick"],We={key:1},je=["onClick"],Le={class:"tw-mt-3"},Ne={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},Pe=["onDragover","onDragleave","onDrop"],ze=["onClick","title"],Be={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},Ve={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},Ie=["title","onClick"],Je=["onClick"],Fe={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},qe={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},He={class:"tw-max-h-48 tw-overflow-y-auto"},Ze={key:0},Ge={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Ke={key:1},Qe=["onClick"],Xe=["onClick"],Ye={key:1},De={key:0},ts=["onClick"],es=["onClick"],ss=["onClick"],ns={key:1},os=["onClick"],rs={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},ls={class:"tw-space-y-1 tw-text-sm"},is={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},as=["onDragstart"],us=["onClick"],ws={class:"tw-relative tw-mt-2"},ds=["onClick"],cs={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},fs={key:0},ps=["onClick"],vs={key:1},gs=["onClick"],_s=["onClick","disabled"],ms={__name:"App",setup(X){const Y=Ut(()=>At(()=>import("./AddManualUserModal-D967k0HM.js"),__vite__mapDeps([0,1]))),I=Ut(()=>At(()=>import("./ReplyContentModal-CRfWvUgy.js"),__vite__mapDeps([2,1]))),S=g([]),R=g({}),f=g({}),y=g(0),_=g(null),C=g(1),$=g([]),x=g(""),b=g(null),E=g({show:!1,message:"",type:"info"}),L=g(!1),N=g({}),q=g(!1),H=g({}),P=g(null),z=g(null),D=g(!1),tt=g(!1),W=g({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,appointment:null,date:null,time:null,type:"consultation"}),et=g(!0),it=g(null),at=B(()=>y.value===0?"æœ¬é€±é ç´„":y.value===1?"ä¸‹é€±é ç´„":y.value===-1?"ä¸Šé€±é ç´„":y.value>1?`æœªä¾†ç¬¬ ${y.value} é€±`:`éå»ç¬¬ ${Math.abs(y.value)} é€±`),Mt=B(()=>{const t=new Map;return S.value.forEach(e=>{e&&e.id!==void 0&&e.id!==null&&t.set(e.id.toString(),e)}),t}),st=B(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(R.value).sort((e,s)=>e==="#"?1:s==="#"?-1:t.indexOf(e)-t.indexOf(s))}),Z=B(()=>{if(!x.value.trim())return S.value;const t=x.value.toLowerCase();return S.value.filter(e=>e.name.toLowerCase().includes(t)||e.zhuyin&&e.zhuyin.toLowerCase().includes(t))}),nt=B(()=>{for(const t in f.value)if(G(f.value[t]))return!0;return!1}),Tt=B(()=>L.value?"ç™¼é€ä¸­...":q.value?"æœ¬é€±æé†’å·²ç™¼é€":nt.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),Rt=B(()=>L.value?"tw-bg-gray-400 tw-text-white":nt.value?q.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function ut(t){return z.value===t}function G(t){if(!t||t.is_closed)return!1;const e=s=>{if(!s)return!1;for(const n in s){const r=s[n];if(r.user_id){const w=Mt.value.get(r.user_id.toString());if(w&&w.line_user_id&&w.line_user_id.startsWith("U"))return!0}}return!1};return e(t.appointments)||e(t.appointments_massage)}function Wt(t){const e=t.date_info.date;return N.value[e]?"ç™¼é€ä¸­...":H.value[e]?"æœ¬æ—¥æé†’å·²ç™¼é€":G(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function jt(t){const e=t.date_info.date;return N.value[e]?"tw-bg-gray-400 tw-text-white":G(t)?H.value[e]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const wt=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},dt=t=>{let e="æœªçŸ¥",s="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";e=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,s=t.last_reply.content||"N/A"}else t.reply_status&&(e=t.reply_status,s=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${e}
å…§å®¹: ${s}`};function d(t,e="success",s=3e3){E.value={show:!0,message:t,type:e},setTimeout(()=>{E.value.show=!1},s)}function K(t){return t.reduce((s,n)=>{const r=n.zhuyin?n.zhuyin[0]:"#";return s[r]||(s[r]=[]),s[r].push(n),s},{})}async function ct(){et.value=!0;try{const t=await M.get(`/api/admin/get_week_appointments?offset=${y.value}`);S.value=t.data.users||[],R.value=K(S.value),f.value=t.data.week_schedule||{},d("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){d("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{et.value=!1}}async function Lt(){try{const e=(await M.get(`/api/admin/get_week_appointments?offset=${y.value}`)).data,s=e.week_schedule||{},n=e.users||[];JSON.stringify(S.value)!==JSON.stringify(n)&&(S.value=n,R.value=K(S.value));for(const r in f.value){const w=f.value[r],o=s[r];if(w&&o){const v=(O,u)=>{if(!O)return;new Set([...Object.keys(O),...Object.keys(u||{})]).forEach(k=>{const V=O[k],Q=u?u[k]:null;Q&&JSON.stringify(V)!==JSON.stringify(Q)?O[k]={...Q}:!Q&&V&&V.user_id&&(O[k]={id:V.id,user_id:null,user_name:null,reply_status:"æœªå›è¦†",last_reply:null})})};v(w.appointments,o.appointments),w.appointments_massage||(w.appointments_massage={}),v(w.appointments_massage,o.appointments_massage),JSON.stringify(w.waiting_list)!==JSON.stringify(o.waiting_list)&&(w.waiting_list=o.waiting_list)}}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function ft(){d("è¼‰å…¥ä¸­...","info"),await ct()}function pt(t){y.value+=t,q.value=!1,H.value={},ct()}function J(){_.value=null,C.value=1,$.value=[],x.value=""}function vt(t,e,s,n="consultation"){const r=`${t}-${e}-${n}`;if(_.value===r)J(),b.value=null;else if(_.value=r,C.value=1,x.value="",b.value=null,s>0){const w=f.value[t],o=n==="massage"?w.appointments_massage:w.appointments;if(w&&o){const O=Object.keys(o)[s-1],u=o[O];u&&u.user_id&&(b.value={id:u.user_id,name:u.user_name})}}}function Nt(t){const e=`waiting-${t}`;_.value===e?J():(_.value=e,C.value=1)}function ot(t){$.value=R.value[t]||[],C.value=2}async function j(t,e,s,n,r=null,w="consultation"){const o=w==="massage"?f.value[t]?.appointments_massage:f.value[t]?.appointments,v=o?.[e]?.user_id,O=o?.[e]?.user_name;if(J(),f.value[t]&&o?.[e]){const u=o[e];u.user_id=s,u.user_name=n,!v&&s?(u.id=Date.now(),u.reply_status="æœªå›è¦†"):v&&!s&&(u.id=null,u.reply_status="æœªå›è¦†",u.last_reply="")}d("å„²å­˜ä¸­...","info");try{const u=await M.post("/api/admin/save_appointment",{date:t,time:e,user_id:s,user_name:n,waiting_list_item_id:typeof r=="number"?r:null,type:w});if(u.data.status==="success"){d("âœ… é ç´„å·²å„²å­˜","success");const h=u.data.appointment;if(h&&f.value[t]&&o?.[e]){const k=o[e];k.id=h.id,k.reply_status=h.reply_status,k.last_reply=h.last_reply,r&&(S.value=S.value.filter(V=>V.id!==s),R.value=K(S.value))}return!0}else throw new Error(u.data.message||"å„²å­˜å¤±æ•—")}catch(u){return d(`âŒ å„²å­˜å¤±æ•—: ${u.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),f.value[t]&&o?.[e]&&(o[e].user_id=v,o[e].user_name=O),!1}}async function Pt(t,e){J(),d("æ–°å¢å‚™å–ä¸­...","info");try{const s=await M.post("/api/admin/waiting_list",{date:t,user_id:e.id,user_name:e.name});if(s.data.status==="success")f.value[t].waiting_list||(f.value[t].waiting_list=[]),f.value[t].waiting_list.push(s.data.item),d("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(s.data.message||"æ–°å¢å¤±æ•—")}catch(s){d(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${s.message}`,"error")}}async function zt(t,e){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await M.delete(`/api/admin/waiting_list/${t}`);const s=f.value[e];s&&s.waiting_list&&(s.waiting_list=s.waiting_list.filter(n=>n.id!==t)),d("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{d("âŒ ç§»é™¤å¤±æ•—","error")}}function F(t,e,s,n="consultation"){_.value.startsWith("waiting-")?Pt(t,s):j(t,e,s.id,s.name,null,n)}function Bt(t,e){P.value=e,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(e))}function Vt(){setTimeout(()=>{P.value=null,z.value=null},50)}function gt(t,e,s,n="consultation"){P.value&&!s.user_id&&(z.value=`${t}-${e}-${n}`)}function _t(t,e,s="consultation"){z.value===`${t}-${e}-${s}`&&(z.value=null)}async function mt(t,e,s="consultation"){if(P.value&&z.value===`${t}-${e}-${s}`){const n={...P.value};z.value=null,await j(t,e,n.user_id,n.user_name,n.id,s)&&(f.value[t].waiting_list=f.value[t].waiting_list.filter(w=>w.id!==n.id))}}async function It(){const t=Object.keys(f.value).sort();let e="";if(t.length>0){const s=f.value[t[0]].date_info.display,n=f.value[t[t.length-1]].date_info.display;e=` (${s} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${at.value}ã€${e} çš„é ç´„æé†’å—ï¼Ÿ`)){L.value=!0;try{const n=(await M.post("/api/admin/send_appointment_reminders",{type:"week",offset:y.value})).data;d(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(q.value=!0)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{L.value=!1}}}async function Jt(t,e){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${e} çš„é ç´„æé†’å—ï¼Ÿ`)){N.value[t]=!0;try{const n=(await M.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(H.value[t]=!0),d(`âœ… å·²ç™¼é€ ${e} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{N.value[t]=!1}}}function Ft(){const{appointment:t,date:e,time:s,type:n}=W.value;yt(t,e,s,n,"æœªå›è¦†"),rt()}async function yt(t,e,s,n="consultation",r=null){const w=f.value[e],o=n==="massage"?w.appointments_massage:w.appointments,v=Object.values(o),O=v.filter(h=>h.id!==t.id&&h.user_id===t.user_id);if(O.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${e} é‚„æœ‰å…¶ä»– ${O.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){d("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const h=await M.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:e});if(h.data.status==="success")v.forEach(k=>{k.user_id===t.user_id&&(k.reply_status="å·²ç¢ºèª")}),d("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(h.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(h){d(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let u;r?u=r:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?u="å·²ç¢ºèª":u="æœªå›è¦†",d("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const h=await M.put(`/api/admin/appointments/${t.id}/reply_status`,{status:u});if(h.data.status==="success"){const k=o[s];k&&(k.reply_status=u,u==="å·²ç¢ºèª"&&k.last_reply?k.last_reply.confirmed=!0:u==="æœªå›è¦†"&&(k.last_reply=null)),d(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${u}ã€`,"success")}else throw new Error(h.data.message||"æ›´æ–°å¤±æ•—")}catch(h){d(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function rt(){W.value.show=!1}function qt(){const{appointment:t,date:e,time:s,type:n}=W.value;t&&t.id&&lt(t.id,e,s,n),rt()}function Ht(t,e,s,n="consultation"){t.last_reply&&(W.value={show:!0,type:t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—",content:t.last_reply.content,isConfirmed:t.last_reply.confirmed,appointment:t,date:e,time:s,type:n})}function ht(t,e,s,n="consultation"){t.last_reply&&!t.last_reply.confirmed?Ht(t,e,s,n):yt(t,e,s,n)}async function lt(t,e,s,n="consultation"){d("ç¢ºèªä¸­...","info");try{const r=await M.post(`/api/admin/appointments/${t}/confirm_reply`);if(r.data.status==="success"){const w=f.value[e],v=(n==="massage"?w.appointments_massage:w.appointments)?.[s];v&&(v.reply_status="å·²ç¢ºèª",v.last_reply&&typeof v.last_reply=="object"&&(v.last_reply.confirmed=!0)),d("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(r.data.message||"ç¢ºèªå¤±æ•—")}catch(r){d(`âŒ ç¢ºèªå¤±æ•—: ${r.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Zt(){D.value=!0}function xt(){D.value=!1}async function Gt(){if(!arguments[0]){d("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}tt.value=!0;try{const t=await M.post("/api/admin/users/add_manual",{name:arguments[0]});if(t.data.status==="success"){const e=t.data.user;S.value.push(e),R.value=K(S.value),d(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${e.name}" å·²æ–°å¢ã€‚`,"success"),xt()}else throw new Error(t.data.message||"æ–°å¢å¤±æ•—")}catch(t){d(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${t.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{tt.value=!1}}const bt=t=>{const e=t.target.closest(".tw-relative"),s=t.target.closest('[draggable="true"]');!e&&!s&&J()};return Kt(()=>{ft(),it.value=setInterval(Lt,15e3),document.addEventListener("click",bt)}),Qt(()=>{clearInterval(it.value),document.removeEventListener("click",bt)}),(t,e)=>(i(),l("div",ee,[a("div",se,[a("div",ne,[a("h2",oe,p(at.value),1)]),a("div",re,[a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:e[0]||(e[0]=s=>pt(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:e[1]||(e[1]=s=>pt(1))},"ä¸‹ä¸€é€± â¡ï¸"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:ft},"ğŸ”„ é‡æ–°è¼‰å…¥"),a("button",{class:T(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",Rt.value]),onClick:It,disabled:L.value||!nt.value},"ğŸ“¨ "+p(Tt.value),11,le),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Zt},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),e[9]||(e[9]=Xt('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),et.value?(i(),l("div",ie,[...e[10]||(e[10]=[a("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),a("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(i(),l("div",ae,[(i(!0),l(U,null,A(f.value,s=>(i(),l("div",{key:s.date_info.date,class:T(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",s.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[a("div",{class:T(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",s.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[a("h3",ue,p(s.date_info.day_name),1),a("p",we,p(s.date_info.display),1)],2),a("div",de,[s.is_closed?(i(),l("div",ce,[...e[11]||(e[11]=[$t(" ğŸ˜´",-1),a("br",null,null,-1),$t("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(i(),l(U,{key:1},[a("div",fe,[e[13]||(e[13]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"çœ‹è¨ºæ™‚æ®µ",-1)),(i(!0),l(U,null,A(s.appointments,(n,r,w)=>(i(),l("div",{key:"consultation-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",pe,p(r),1),a("div",{class:T(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":ut(`${s.date_info.date}-${r}-consultation`)}]),onDragover:c(o=>gt(s.date_info.date,r,n,"consultation"),["prevent"]),onDragleave:o=>_t(s.date_info.date,r,"consultation"),onDrop:c(o=>mt(s.date_info.date,r,"consultation"),["prevent"])},[a("div",{class:T(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(s.date_info.date,r,w,"consultation"),title:n.user_name||"æœªé ç´„"},[a("span",_e,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",me,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>ht(n,s.date_info.date,r,"consultation"),["stop"])},p(wt(n)),9,ye),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:c(o=>lt(n.id,s.date_info.date,r,"consultation"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,he)):m("",!0)])):m("",!0),e[12]||(e[12]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,ge),_.value===`${s.date_info.date}-${r}-consultation`?(i(),l("div",xe,[a("div",be,[Ct(a("input",{"onUpdate:modelValue":e[2]||(e[2]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:e[3]||(e[3]=c(()=>{},["stop"])),ref_for:!0,ref:"searchInput"},null,512),[[St,x.value]])]),a("div",ke,[x.value.trim()?(i(),l("div",$e,[Z.value.length===0?(i(),l("div",Ce," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(i(),l("div",Se,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Ee),(i(!0),l(U,null,A(Z.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>F(s.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,Ue))),128))]))])):(i(),l("div",Oe,[C.value===1?(i(),l("div",Ae,[b.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,b.value.id,b.value.name,null,"consultation"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,Me)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Te),(i(!0),l(U,null,A(st.value,o=>(i(),l("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,Re))),128))])):m("",!0),C.value===2?(i(),l("div",We,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:e[4]||(e[4]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(U,null,A($.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>F(s.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,je))),128))])):m("",!0)]))])])):m("",!0)],42,ve)]))),128))]),a("div",Le,[e[15]||(e[15]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"æ¨æ‹¿æ™‚æ®µ",-1)),(i(!0),l(U,null,A(s.appointments_massage,(n,r,w)=>(i(),l("div",{key:"massage-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",Ne,p(r),1),a("div",{class:T(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":ut(`${s.date_info.date}-${r}-massage`)}]),onDragover:c(o=>gt(s.date_info.date,r,n,"massage"),["prevent"]),onDragleave:o=>_t(s.date_info.date,r,"massage"),onDrop:c(o=>mt(s.date_info.date,r,"massage"),["prevent"])},[a("div",{class:T(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(s.date_info.date,r,w,"massage"),title:n.user_name||"æœªé ç´„"},[a("span",Be,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",Ve,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>ht(n,s.date_info.date,r,"massage"),["stop"])},p(wt(n)),9,Ie),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:c(o=>lt(n.id,s.date_info.date,r,"massage"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,Je)):m("",!0)])):m("",!0),e[14]||(e[14]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,ze),_.value===`${s.date_info.date}-${r}-massage`?(i(),l("div",Fe,[a("div",qe,[Ct(a("input",{"onUpdate:modelValue":e[5]||(e[5]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:e[6]||(e[6]=c(()=>{},["stop"]))},null,512),[[St,x.value]])]),a("div",He,[x.value.trim()?(i(),l("div",Ze,[Z.value.length===0?(i(),l("div",Ge," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(i(),l("div",Ke,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,Qe),(i(!0),l(U,null,A(Z.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>F(s.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,Xe))),128))]))])):(i(),l("div",Ye,[C.value===1?(i(),l("div",De,[b.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,b.value.id,b.value.name,null,"massage"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,ts)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>j(s.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,es),(i(!0),l(U,null,A(st.value,o=>(i(),l("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,ss))),128))])):m("",!0),C.value===2?(i(),l("div",ns,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:e[7]||(e[7]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(U,null,A($.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>F(s.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,os))),128))])):m("",!0)]))])])):m("",!0)],42,Pe)]))),128))])],64))]),s.is_closed?m("",!0):(i(),l("div",rs,[e[16]||(e[16]=a("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),a("div",ls,[!s.waiting_list||s.waiting_list.length===0?(i(),l("div",is,"å°šç„¡å‚™å–")):m("",!0),(i(!0),l(U,null,A(s.waiting_list,n=>(i(),l("div",{key:n.id,class:T(["tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab tw-transition-opacity",{"tw-opacity-40":P.value&&P.value.id===n.id}]),draggable:"true",onDragstart:r=>Bt(r,n),onDragend:Vt},[a("span",null,p(n.user_name),1),a("button",{onClick:r=>zt(n.id,s.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,us)],42,as))),128))]),a("div",ws,[a("button",{onClick:n=>Nt(s.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,ds),_.value===`waiting-${s.date_info.date}`?(i(),l("div",cs,[C.value===1?(i(),l("div",fs,[(i(!0),l(U,null,A(st.value,n=>(i(),l("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>ot(n),["stop"])},p(n),9,ps))),128))])):m("",!0),C.value===2?(i(),l("div",vs,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:e[8]||(e[8]=c(n=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(U,null,A($.value,n=>(i(),l("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>F(s.date_info.date,null,n),["stop"])},p(n.name),9,gs))),128))])):m("",!0)])):m("",!0)])])),s.is_closed?m("",!0):(i(),l("button",{key:1,class:T(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",jt(s)]),onClick:n=>Jt(s.date_info.date,s.date_info.day_name),disabled:N.value[s.date_info.date]||!G(s)},p(Wt(s)),11,_s))],2))),128))])),E.value.show?(i(),l("div",{key:2,class:T(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",E.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},p(E.value.message),3)):m("",!0),kt(Et(Y),{show:D.value,"is-adding":tt.value,onClose:xt,onSubmit:Gt},null,8,["show","is-adding"]),kt(Et(I),{show:W.value.show,type:W.value.type,content:W.value.content,"is-confirmed":W.value.isConfirmed,onClose:rt,onConfirm:qt,onResetStatus:Ft},null,8,["show","type","content","is-confirmed"])]))}};Yt(ms).mount("#app");
