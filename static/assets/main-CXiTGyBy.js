const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddManualUserModal-D967k0HM.js","assets/runtime-dom.esm-bundler-wIgYT9iR.js","assets/ReplyContentModal-CRfWvUgy.js"])))=>i.map(i=>d[i]);
import{r as g,c as z,o as Qt,a as Xt,b as l,d as i,e as a,f as m,g as kt,h as Yt,t as p,n as O,F as L,i as T,j as $t,w as c,k as Ct,v as St,u as Et,l as Lt,m as Dt}from"./runtime-dom.esm-bundler-wIgYT9iR.js";import{a as I}from"./index-R-lXtGyY.js";const te="modulepreload",ee=function(X){return"/static/"+X},Ut={},Tt=function(Y,V,S){let A=Promise.resolve();if(V&&V.length>0){let C=function($){return Promise.all($.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),_=y?.nonce||y?.getAttribute("nonce");A=C(V.map($=>{if($=ee($),$ in Ut)return;Ut[$]=!0;const x=$.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${$}"]${b}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":te,x||(E.as="script"),E.crossOrigin="",E.href=$,_&&E.setAttribute("nonce",_),document.head.appendChild(E),x)return new Promise((N,R)=>{E.addEventListener("load",N),E.addEventListener("error",()=>R(new Error(`Unable to preload CSS for ${$}`)))})}))}function f(y){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=y,window.dispatchEvent(_),!_.defaultPrevented)throw y}return A.then(y=>{for(const _ of y||[])_.status==="rejected"&&f(_.reason);return Y().catch(f)})},se={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},ne={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},oe={class:"tw-text-center tw-mb-4"},re={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},le={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},ie=["disabled"],ae={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},ue={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},we={class:"tw-text-base tw-font-bold"},de={class:"tw-text-sm tw-opacity-90"},ce={class:"tw-flex-grow tw-space-y-1"},fe={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},pe={class:"tw-mb-2"},ve={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},ge=["onDragover","onDragleave","onDrop"],_e=["onClick","title"],me={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},ye={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},he=["title","onClick"],xe=["onClick"],be={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},ke={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},$e={class:"tw-max-h-48 tw-overflow-y-auto"},Ce={key:0},Se={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Ee={key:1},Le=["onClick"],Ue=["onClick"],Te={key:1},Ie={key:0},Oe=["onClick"],Ae=["onClick"],Me=["onClick"],Fe={key:1},Ne=["onClick"],Re={class:"tw-mt-3"},je={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},We=["onDragover","onDragleave","onDrop"],ze=["onClick","title"],Pe={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},Ve={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},Be=["title","onClick"],Je=["onClick"],qe={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},He={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},Ke={class:"tw-max-h-48 tw-overflow-y-auto"},Ze={key:0},Ge={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Qe={key:1},Xe=["onClick"],Ye=["onClick"],De={key:1},ts={key:0},es=["onClick"],ss=["onClick"],ns=["onClick"],os={key:1},rs=["onClick"],ls={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},is={class:"tw-space-y-1 tw-text-sm"},as={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},us=["onDragstart"],ws=["onClick"],ds={class:"tw-relative tw-mt-2"},cs=["onClick"],fs={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},ps={key:0},vs=["onClick"],gs={key:1},_s=["onClick"],ms=["onClick","disabled"],ys={__name:"App",setup(X){const Y=Lt(()=>Tt(()=>import("./AddManualUserModal-D967k0HM.js"),__vite__mapDeps([0,1]))),V=Lt(()=>Tt(()=>import("./ReplyContentModal-CRfWvUgy.js"),__vite__mapDeps([2,1]))),S=g([]),A=g({}),f=g({}),y=g(0),_=g(null),C=g(1),$=g([]),x=g(""),b=g(null),E=g({show:!1,message:"",type:"info"}),N=g(!1),R=g({}),q=g(!1),H=g({}),j=g(null),W=g(null),D=g(!1),tt=g(!1),M=g({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,appointment:null,date:null,time:null,type:"consultation"}),et=g(!0),it=g(null),at=z(()=>y.value===0?"æœ¬é€±é ç´„":y.value===1?"ä¸‹é€±é ç´„":y.value===-1?"ä¸Šé€±é ç´„":y.value>1?`æœªä¾†ç¬¬ ${y.value} é€±`:`éå»ç¬¬ ${Math.abs(y.value)} é€±`),It=z(()=>{const t=new Map;return S.value.forEach(s=>{s&&s.id!==void 0&&s.id!==null&&t.set(s.id.toString(),s)}),t}),st=z(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(A.value).sort((s,e)=>s==="#"?1:e==="#"?-1:t.indexOf(s)-t.indexOf(e))}),K=z(()=>{if(!x.value.trim())return S.value;const t=x.value.toLowerCase();return S.value.filter(s=>s.name.toLowerCase().includes(t)||s.zhuyin&&s.zhuyin.toLowerCase().includes(t))}),nt=z(()=>{for(const t in f.value)if(Z(f.value[t]))return!0;return!1}),Ot=z(()=>N.value?"ç™¼é€ä¸­...":q.value?"æœ¬é€±æé†’å·²ç™¼é€":nt.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),At=z(()=>N.value?"tw-bg-gray-400 tw-text-white":nt.value?q.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function ut(t){return W.value===t}function Z(t){if(!t||t.is_closed)return!1;const s=e=>{if(!e)return!1;for(const n in e){const r=e[n];if(r.user_id){const u=It.value.get(r.user_id.toString());if(u&&u.line_user_id&&u.line_user_id.startsWith("U"))return!0}}return!1};return s(t.appointments)||s(t.appointments_massage)}function Mt(t){const s=t.date_info.date;return R.value[s]?"ç™¼é€ä¸­...":H.value[s]?"æœ¬æ—¥æé†’å·²ç™¼é€":Z(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function Ft(t){const s=t.date_info.date;return R.value[s]?"tw-bg-gray-400 tw-text-white":Z(t)?H.value[s]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const wt=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},dt=t=>{let s="æœªçŸ¥",e="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";s=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,e=t.last_reply.content||"N/A"}else t.reply_status&&(s=t.reply_status,e=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${s}
å…§å®¹: ${e}`};function d(t,s="success",e=3e3){E.value={show:!0,message:t,type:s},setTimeout(()=>{E.value.show=!1},e)}function G(t){return t.reduce((e,n)=>{const r=n.zhuyin?n.zhuyin[0]:"#";return e[r]||(e[r]=[]),e[r].push(n),e},{})}async function ct(){et.value=!0;try{const t=await I.get(`/api/admin/get_week_appointments?offset=${y.value}`);S.value=t.data.users||[],A.value=G(S.value),f.value=t.data.week_schedule||{},d("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){d("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{et.value=!1}}async function Nt(){try{const s=(await I.get(`/api/admin/get_week_appointments?offset=${y.value}`)).data,e=s.week_schedule||{},n=s.users||[];JSON.stringify(S.value)!==JSON.stringify(n)&&(S.value=n,A.value=G(S.value));for(const r in f.value){const u=f.value[r],o=e[r];if(u&&o){const v=(U,w)=>{if(!U)return;new Set([...Object.keys(U),...Object.keys(w||{})]).forEach(k=>{const P=U[k],Q=w?w[k]:null;Q&&JSON.stringify(P)!==JSON.stringify(Q)?U[k]={...Q}:!Q&&P&&P.user_id&&(U[k]={id:P.id,user_id:null,user_name:null,reply_status:"æœªå›è¦†",last_reply:null})})};v(u.appointments,o.appointments),u.appointments_massage||(u.appointments_massage={}),v(u.appointments_massage,o.appointments_massage),JSON.stringify(u.waiting_list)!==JSON.stringify(o.waiting_list)&&(u.waiting_list=o.waiting_list)}}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function ft(){d("è¼‰å…¥ä¸­...","info"),await ct()}function pt(t){y.value+=t,q.value=!1,H.value={},ct()}function B(){_.value=null,C.value=1,$.value=[],x.value=""}function vt(t,s,e,n="consultation"){const r=`${t}-${s}-${n}`;if(_.value===r)B(),b.value=null;else if(_.value=r,C.value=1,x.value="",b.value=null,e>0){const u=f.value[t],o=n==="massage"?u.appointments_massage:u.appointments;if(u&&o){const U=Object.keys(o).sort()[e-1],w=o[U];w&&w.user_id&&(b.value={id:w.user_id,name:w.user_name})}}}function Rt(t){const s=`waiting-${t}`;_.value===s?B():(_.value=s,C.value=1)}function ot(t){$.value=A.value[t]||[],C.value=2}async function F(t,s,e,n,r=null,u="consultation"){const o=u==="massage"?f.value[t]?.appointments_massage:f.value[t]?.appointments,v=o?.[s]?.user_id,U=o?.[s]?.user_name;if(B(),f.value[t]&&o?.[s]){const w=o[s];w.user_id=e,w.user_name=n,!v&&e?(w.id=Date.now(),w.reply_status="æœªå›è¦†"):v&&!e&&(w.id=null,w.reply_status="æœªå›è¦†",w.last_reply="")}d("å„²å­˜ä¸­...","info");try{const w=await I.post("/api/admin/save_appointment",{date:t,time:s,user_id:e,user_name:n,waiting_list_item_id:r?Number(r):null,type:u});if(w.data.status==="success"){d("âœ… é ç´„å·²å„²å­˜","success");const h=w.data.appointment;if(h&&f.value[t]&&o?.[s]){const k=o[s];k.id=h.id,k.reply_status=h.reply_status,k.last_reply=h.last_reply,r&&(S.value=S.value.filter(P=>P.id!==e),A.value=G(S.value))}return!0}else throw new Error(w.data.message||"å„²å­˜å¤±æ•—")}catch(w){return d(`âŒ å„²å­˜å¤±æ•—: ${w.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),f.value[t]&&o?.[s]&&(o[s].user_id=v,o[s].user_name=U),!1}}async function jt(t,s){B(),d("æ–°å¢å‚™å–ä¸­...","info");try{const e=await I.post("/api/admin/waiting_list",{date:t,user_id:s.id,user_name:s.name});if(e.data.status==="success")f.value[t].waiting_list||(f.value[t].waiting_list=[]),f.value[t].waiting_list.push(e.data.item),d("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(e.data.message||"æ–°å¢å¤±æ•—")}catch(e){d(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${e.message}`,"error")}}async function Wt(t,s){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await I.delete(`/api/admin/waiting_list/${t}`);const e=f.value[s];e&&e.waiting_list&&(e.waiting_list=e.waiting_list.filter(n=>n.id!==t)),d("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{d("âŒ ç§»é™¤å¤±æ•—","error")}}function J(t,s,e,n="consultation"){_.value.startsWith("waiting-")?jt(t,e):F(t,s,e.id,e.name,null,n)}function zt(t,s){j.value=s,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(s))}function Pt(){setTimeout(()=>{j.value=null,W.value=null},50)}function gt(t,s,e,n="consultation"){j.value&&!e.user_id&&(W.value=`${t}-${s}-${n}`)}function _t(t,s,e="consultation"){W.value===`${t}-${s}-${e}`&&(W.value=null)}async function mt(t,s,e="consultation"){if(j.value&&W.value===`${t}-${s}-${e}`){const n={...j.value};W.value=null,await F(t,s,n.user_id,n.user_name,n.id,e)&&(f.value[t].waiting_list=f.value[t].waiting_list.filter(u=>u.id!==n.id))}}async function Vt(){const t=Object.keys(f.value).sort();let s="";if(t.length>0){const e=f.value[t[0]].date_info.display,n=f.value[t[t.length-1]].date_info.display;s=` (${e} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${at.value}ã€${s} çš„é ç´„æé†’å—ï¼Ÿ`)){N.value=!0;try{const n=(await I.post("/api/admin/send_appointment_reminders",{type:"week",offset:y.value})).data;d(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(q.value=!0)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{N.value=!1}}}async function Bt(t,s){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${s} çš„é ç´„æé†’å—ï¼Ÿ`)){R.value[t]=!0;try{const n=(await I.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(H.value[t]=!0),d(`âœ… å·²ç™¼é€ ${s} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{R.value[t]=!1}}}function Jt(){const{appointment:t,date:s,time:e,type:n}=M.value;yt(t,s,e,n,"æœªå›è¦†"),rt()}async function yt(t,s,e,n="consultation",r=null){const u=f.value[s],o=n==="massage"?u.appointments_massage:u.appointments,v=Object.values(o),U=v.filter(h=>h.id!==t.id&&h.user_id===t.user_id);if(U.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${s} é‚„æœ‰å…¶ä»– ${U.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){d("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const h=await I.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:s});if(h.data.status==="success")v.forEach(k=>{k.user_id===t.user_id&&(k.reply_status="å·²ç¢ºèª")}),d("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(h.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(h){d(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let w;r?w=r:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?w="å·²ç¢ºèª":w="æœªå›è¦†",d("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const h=await I.put(`/api/admin/appointments/${t.id}/reply_status`,{status:w});if(h.data.status==="success"){const k=o[e];k&&(k.reply_status=w,w==="å·²ç¢ºèª"&&k.last_reply?k.last_reply.confirmed=!0:w==="æœªå›è¦†"&&(k.last_reply=null)),d(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${w}ã€`,"success")}else throw new Error(h.data.message||"æ›´æ–°å¤±æ•—")}catch(h){d(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function rt(){M.value.show=!1}function qt(){const{appointment:t,date:s,time:e,type:n}=M.value;t&&t.id&&lt(t.id,s,e,n),rt()}function Ht(t,s,e,n="consultation"){if(!t.last_reply)return;let r="æ–‡å­—",u="",o=!1;typeof t.last_reply=="string"?(u=t.last_reply,o=t.reply_status==="å·²ç¢ºèª"):(r=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—",u=t.last_reply.content,o=t.last_reply.confirmed),M.value={show:!0,type:r,content:u,isConfirmed:o,appointment:t,date:s,time:e,type:n}}function ht(t,s,e,n="consultation"){const r=t.last_reply;let u=!1;r&&(typeof t.last_reply=="object"?u=t.last_reply.confirmed:u=t.reply_status==="å·²ç¢ºèª"),r&&!u?Ht(t,s,e,n):yt(t,s,e,n)}async function lt(t,s,e,n="consultation"){d("ç¢ºèªä¸­...","info");try{const r=await I.post(`/api/admin/appointments/${t}/confirm_reply`);if(r.data.status==="success"){const u=f.value[s],v=(n==="massage"?u.appointments_massage:u.appointments)?.[e];v&&(v.reply_status="å·²ç¢ºèª",v.last_reply&&typeof v.last_reply=="object"&&(v.last_reply.confirmed=!0)),d("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(r.data.message||"ç¢ºèªå¤±æ•—")}catch(r){d(`âŒ ç¢ºèªå¤±æ•—: ${r.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Kt(){D.value=!0}function xt(){D.value=!1}async function Zt(){if(!arguments[0]){d("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}tt.value=!0;try{const t=await I.post("/api/admin/users/add_manual",{name:arguments[0]});if(t.data.status==="success"){const s=t.data.user;S.value.push(s),A.value=G(S.value),d(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${s.name}" å·²æ–°å¢ã€‚`,"success"),xt()}else throw new Error(t.data.message||"æ–°å¢å¤±æ•—")}catch(t){d(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${t.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{tt.value=!1}}const bt=t=>{const s=t.target.closest(".tw-relative"),e=t.target.closest('[draggable="true"]');!s&&!e&&B()};async function Gt(){try{console.warn("VITE_LIFF_ID is not defined. LIFF initialization skipped.");return}catch(t){console.error("LIFF initialization failed:",t)}}return Qt(()=>{Gt(),ft(),it.value=setInterval(Nt,15e3),document.addEventListener("click",bt)}),Xt(()=>{clearInterval(it.value),document.removeEventListener("click",bt)}),(t,s)=>(i(),l("div",se,[a("div",ne,[a("div",oe,[a("h2",re,p(at.value),1)]),a("div",le,[a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[0]||(s[0]=e=>pt(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[1]||(s[1]=e=>pt(1))},"ä¸‹ä¸€é€± â¡ï¸"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:ft},"ğŸ”„ é‡æ–°è¼‰å…¥"),a("button",{class:O(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",At.value]),onClick:Vt,disabled:N.value||!nt.value},"ğŸ“¨ "+p(Ot.value),11,ie),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Kt},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),s[9]||(s[9]=Yt('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),et.value?(i(),l("div",ae,[...s[10]||(s[10]=[a("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),a("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(i(),l("div",ue,[(i(!0),l(L,null,T(f.value,e=>(i(),l("div",{key:e.date_info.date,class:O(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",e.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[a("div",{class:O(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",e.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[a("h3",we,p(e.date_info.day_name),1),a("p",de,p(e.date_info.display),1)],2),a("div",ce,[e.is_closed?(i(),l("div",fe,[...s[11]||(s[11]=[$t(" ğŸ˜´",-1),a("br",null,null,-1),$t("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(i(),l(L,{key:1},[a("div",pe,[s[13]||(s[13]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"çœ‹è¨ºæ™‚æ®µ",-1)),(i(!0),l(L,null,T(e.appointments,(n,r,u)=>(i(),l("div",{key:"consultation-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",ve,p(r),1),a("div",{class:O(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":ut(`${e.date_info.date}-${r}-consultation`)}]),onDragover:c(o=>gt(e.date_info.date,r,n,"consultation"),["prevent"]),onDragleave:o=>_t(e.date_info.date,r,"consultation"),onDrop:c(o=>mt(e.date_info.date,r,"consultation"),["prevent"])},[a("div",{class:O(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(e.date_info.date,r,u,"consultation"),title:n.user_name||"æœªé ç´„"},[a("span",me,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",ye,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>ht(n,e.date_info.date,r,"consultation"),["stop"])},p(wt(n)),9,he),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:c(o=>lt(n.id,e.date_info.date,r,"consultation"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,xe)):m("",!0)])):m("",!0),s[12]||(s[12]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,_e),_.value===`${e.date_info.date}-${r}-consultation`?(i(),l("div",be,[a("div",ke,[Ct(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:s[3]||(s[3]=c(()=>{},["stop"])),ref_for:!0,ref:"searchInput"},null,512),[[St,x.value]])]),a("div",$e,[x.value.trim()?(i(),l("div",Ce,[K.value.length===0?(i(),l("div",Se," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(i(),l("div",Ee,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Le),(i(!0),l(L,null,T(K.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>J(e.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,Ue))),128))]))])):(i(),l("div",Te,[C.value===1?(i(),l("div",Ie,[b.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,b.value.id,b.value.name,null,"consultation"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,Oe)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Ae),(i(!0),l(L,null,T(st.value,o=>(i(),l("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,Me))),128))])):m("",!0),C.value===2?(i(),l("div",Fe,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[4]||(s[4]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(L,null,T($.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>J(e.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,Ne))),128))])):m("",!0)]))])])):m("",!0)],42,ge)]))),128))]),a("div",Re,[s[15]||(s[15]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"æ¨æ‹¿æ™‚æ®µ",-1)),(i(!0),l(L,null,T(e.appointments_massage,(n,r,u)=>(i(),l("div",{key:"massage-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",je,p(r),1),a("div",{class:O(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":ut(`${e.date_info.date}-${r}-massage`)}]),onDragover:c(o=>gt(e.date_info.date,r,n,"massage"),["prevent"]),onDragleave:o=>_t(e.date_info.date,r,"massage"),onDrop:c(o=>mt(e.date_info.date,r,"massage"),["prevent"])},[a("div",{class:O(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(e.date_info.date,r,u,"massage"),title:n.user_name||"æœªé ç´„"},[a("span",Pe,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",Ve,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>ht(n,e.date_info.date,r,"massage"),["stop"])},p(wt(n)),9,Be),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:c(o=>lt(n.id,e.date_info.date,r,"massage"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,Je)):m("",!0)])):m("",!0),s[14]||(s[14]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,ze),_.value===`${e.date_info.date}-${r}-massage`?(i(),l("div",qe,[a("div",He,[Ct(a("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:s[6]||(s[6]=c(()=>{},["stop"]))},null,512),[[St,x.value]])]),a("div",Ke,[x.value.trim()?(i(),l("div",Ze,[K.value.length===0?(i(),l("div",Ge," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(i(),l("div",Qe,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,Xe),(i(!0),l(L,null,T(K.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>J(e.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,Ye))),128))]))])):(i(),l("div",De,[C.value===1?(i(),l("div",ts,[b.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,b.value.id,b.value.name,null,"massage"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,es)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>F(e.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,ss),(i(!0),l(L,null,T(st.value,o=>(i(),l("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,ns))),128))])):m("",!0),C.value===2?(i(),l("div",os,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[7]||(s[7]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(L,null,T($.value,o=>(i(),l("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>J(e.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,rs))),128))])):m("",!0)]))])])):m("",!0)],42,We)]))),128))])],64))]),e.is_closed?m("",!0):(i(),l("div",ls,[s[16]||(s[16]=a("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),a("div",is,[!e.waiting_list||e.waiting_list.length===0?(i(),l("div",as,"å°šç„¡å‚™å–")):m("",!0),(i(!0),l(L,null,T(e.waiting_list,n=>(i(),l("div",{key:n.id,class:O(["tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab tw-transition-opacity",{"tw-opacity-40":j.value&&j.value.id===n.id}]),draggable:"true",onDragstart:r=>zt(r,n),onDragend:Pt},[a("span",null,p(n.user_name),1),a("button",{onClick:r=>Wt(n.id,e.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,ws)],42,us))),128))]),a("div",ds,[a("button",{onClick:n=>Rt(e.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,cs),_.value===`waiting-${e.date_info.date}`?(i(),l("div",fs,[C.value===1?(i(),l("div",ps,[(i(!0),l(L,null,T(st.value,n=>(i(),l("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>ot(n),["stop"])},p(n),9,vs))),128))])):m("",!0),C.value===2?(i(),l("div",gs,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[8]||(s[8]=c(n=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(L,null,T($.value,n=>(i(),l("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>J(e.date_info.date,null,n),["stop"])},p(n.name),9,_s))),128))])):m("",!0)])):m("",!0)])])),e.is_closed?m("",!0):(i(),l("button",{key:1,class:O(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",Ft(e)]),onClick:n=>Bt(e.date_info.date,e.date_info.day_name),disabled:R.value[e.date_info.date]||!Z(e)},p(Mt(e)),11,ms))],2))),128))])),E.value.show?(i(),l("div",{key:2,class:O(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",E.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},p(E.value.message),3)):m("",!0),kt(Et(Y),{show:D.value,"is-adding":tt.value,onClose:xt,onSubmit:Zt},null,8,["show","is-adding"]),kt(Et(V),{show:M.value.show,type:M.value.type,content:M.value.content,"is-confirmed":M.value.isConfirmed,onClose:rt,onConfirm:qt,onResetStatus:Jt},null,8,["show","type","content","is-confirmed"])]))}};Dt(ys).mount("#app");
