import{r as p,c as A,o as Tt,a as jt,b as l,d as i,e as o,f as v,g as Rt,t as f,n as C,F as S,h as M,i as q,w as _,j as Et,v as Wt,k as Lt,l as Nt}from"./runtime-dom.esm-bundler-jAXvPR8n.js";import{a as m}from"./index-R-lXtGyY.js";const zt={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},Bt={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},Ft={class:"tw-text-center tw-mb-4"},It={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},Vt={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},Jt=["disabled"],Kt={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},Ht={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},Pt={class:"tw-text-base tw-font-bold"},Zt={class:"tw-text-sm tw-opacity-90"},Gt={class:"tw-flex-grow tw-space-y-1"},qt={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},Qt={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},Xt=["onDragover","onDragleave","onDrop"],Yt=["onClick","title"],Dt={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},te={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},ee=["title","onClick"],se=["onClick"],ne={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mt-1"},oe={key:0},re=["onClick"],le=["onClick"],ie=["onClick"],ae={key:1},we=["onClick"],ue={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},de={class:"tw-space-y-1 tw-text-sm"},ce={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},pe=["onDragstart"],fe=["onClick"],ve={class:"tw-relative tw-mt-2"},ge=["onClick"],_e={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},me={key:0},ye=["onClick"],be={key:1},xe=["onClick"],he=["onClick","disabled"],ke={key:3,class:"tw-fixed tw-inset-0 tw-bg-gray-600 tw-bg-opacity-50 tw-overflow-y-auto tw-h-full tw-w-full tw-z-50 tw-flex tw-justify-center tw-items-center"},$e={class:"tw-relative tw-p-5 tw-border tw-w-96 tw-shadow-lg tw-rounded-md tw-bg-white"},Ce={class:"tw-mt-4 tw-flex tw-justify-end tw-space-x-2"},Se=["disabled"],Me={key:0},Ue={key:1},Ae={class:"tw-relative tw-p-5 tw-border tw-w-full sm:tw-w-96 tw-shadow-lg tw-rounded-md tw-bg-white"},Oe={class:"tw-bg-gray-100 tw-p-3 tw-rounded-md tw-mb-4 tw-min-h-[60px]"},Te={class:"tw-text-sm tw-text-gray-500"},je={class:"tw-font-semibold tw-text-gray-800"},Re={class:"tw-text-base tw-text-gray-800 tw-break-words"},Ee={class:"tw-mt-4 tw-flex tw-justify-end tw-space-x-2"},We={__name:"App",setup(Le){const O=p([]),z=p({}),w=p({}),y=p(0),x=p(null),b=p(1),B=p([]),k=p(null),T=p({show:!1,message:"",type:"info"}),j=p(!1),R=p({}),F=p(!1),I=p({}),h=p(null),U=p(null),H=p(!1),E=p(""),V=p(!1),W=p({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,time:null}),P=p(!0),Q=p(null),X=A(()=>y.value===0?"æœ¬é€±é ç´„":y.value===1?"ä¸‹é€±é ç´„":y.value===-1?"ä¸Šé€±é ç´„":y.value>1?`æœªä¾†ç¬¬ ${y.value} é€±`:`éå»ç¬¬ ${Math.abs(y.value)} é€±`),at=A(()=>{const t=new Map;return O.value.forEach(e=>{e&&e.id!==void 0&&e.id!==null&&t.set(e.id.toString(),e)}),t}),Y=A(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(z.value).sort((e,s)=>e==="#"?1:s==="#"?-1:t.indexOf(e)-t.indexOf(s))}),Z=A(()=>{for(const t in w.value)if(J(w.value[t]))return!0;return!1}),wt=A(()=>j.value?"ç™¼é€ä¸­...":F.value?"æœ¬é€±æé†’å·²ç™¼é€":Z.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),ut=A(()=>j.value?"tw-bg-gray-400 tw-text-white":Z.value?F.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function dt(t){return U.value===t}function J(t){if(!t||t.is_closed||!t.appointments)return!1;for(const e in t.appointments){const s=t.appointments[e];if(s.user_id){const n=at.value.get(s.user_id.toString());if(n&&n.line_user_id&&n.line_user_id.startsWith("U"))return!0}}return!1}function ct(t){const e=t.date_info.date;return R.value[e]?"ç™¼é€ä¸­...":I.value[e]?"æœ¬æ—¥æé†’å·²ç™¼é€":J(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function pt(t){const e=t.date_info.date;return R.value[e]?"tw-bg-gray-400 tw-text-white":J(t)?I.value[e]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const ft=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},vt=t=>{let e="æœªçŸ¥",s="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";e=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,s=t.last_reply.content||"N/A"}else t.reply_status&&(e=t.reply_status,s=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${e}
å…§å®¹: ${s}`};function d(t,e="success",s=3e3){T.value={show:!0,message:t,type:e},setTimeout(()=>{T.value.show=!1},s)}function D(t){return t.reduce((s,n)=>{const r=n.zhuyin?n.zhuyin[0]:"#";return s[r]||(s[r]=[]),s[r].push(n),s},{})}async function tt(){P.value=!0;try{const t=await m.get(`/api/admin/get_week_appointments?offset=${y.value}`);O.value=t.data.users||[],z.value=D(O.value),w.value=t.data.week_schedule||{},d("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){d("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{P.value=!1}}async function gt(){try{const e=(await m.get(`/api/admin/get_week_appointments?offset=${y.value}`)).data,s=e.week_schedule||{},n=e.users||[],r=new Map;n.forEach(c=>{c&&c.id&&r.set(c.id.toString(),c)});for(const c in w.value)if(s[c]){const a=w.value[c],u=s[c];for(const $ in a.appointments){const g=a.appointments[$],N=u.appointments[$];if(g&&N&&((JSON.stringify(g.last_reply)!==JSON.stringify(N.last_reply)||g.reply_status!==N.reply_status)&&(g.last_reply=N.last_reply,g.reply_status=N.reply_status),g.user_id)){const G=r.get(g.user_id.toString());G&&g.user_name!==G.name&&(g.user_name=G.name)}}}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function et(){d("è¼‰å…¥ä¸­...","info"),await tt()}function st(t){y.value+=t,F.value=!1,I.value={},tt()}function L(){x.value=null,b.value=1,B.value=[]}function _t(t,e,s){const n=`${t}-${e}`;if(x.value===n)L(),k.value=null;else if(x.value=n,b.value=1,k.value=null,s>0){const r=w.value[t];if(r&&r.appointments){const a=Object.keys(r.appointments)[s-1],u=r.appointments[a];u&&u.user_id&&(k.value={id:u.user_id,name:u.user_name})}}}function mt(t){const e=`waiting-${t}`;x.value===e?L():(x.value=e,b.value=1)}function nt(t){B.value=z.value[t]||[],b.value=2}async function K(t,e,s,n,r=null){const c=w.value[t]?.appointments[e]?.user_id,a=w.value[t]?.appointments[e]?.user_name;if(L(),w.value[t]&&w.value[t].appointments[e]){const u=w.value[t].appointments[e];u.user_id=s,u.user_name=n,!c&&s?(u.id=Date.now(),u.reply_status="æœªå›è¦†"):c&&!s&&(u.id=null,u.reply_status="æœªå›è¦†",u.last_reply="")}d("å„²å­˜ä¸­...","info");try{const u=await m.post("/api/admin/save_appointment",{date:t,time:e,user_id:s,user_name:n,waiting_list_item_id:typeof r=="number"?r:null});if(u.data.status==="success"){d("âœ… é ç´„å·²å„²å­˜","success");const $=u.data.appointment;if($&&w.value[t]&&w.value[t].appointments[e]){const g=w.value[t].appointments[e];g.id=$.id,g.reply_status=$.reply_status,g.last_reply=$.last_reply}}else throw new Error(u.data.message||"å„²å­˜å¤±æ•—")}catch(u){d(`âŒ å„²å­˜å¤±æ•—: ${u.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),w.value[t]&&w.value[t].appointments[e]&&(w.value[t].appointments[e].user_id=c,w.value[t].appointments[e].user_name=a)}}async function yt(t,e){L(),d("æ–°å¢å‚™å–ä¸­...","info");try{const s=await m.post("/api/admin/waiting_list",{date:t,user_id:e.id,user_name:e.name});if(s.data.status==="success")w.value[t].waiting_list||(w.value[t].waiting_list=[]),w.value[t].waiting_list.push(s.data.item),d("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(s.data.message||"æ–°å¢å¤±æ•—")}catch(s){d(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${s.message}`,"error")}}async function bt(t,e){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await m.delete(`/api/admin/waiting_list/${t}`);const s=w.value[e];s&&s.waiting_list&&(s.waiting_list=s.waiting_list.filter(n=>n.id!==t)),d("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{d("âŒ ç§»é™¤å¤±æ•—","error")}}function ot(t,e,s){x.value.startsWith("waiting-")?yt(t,s):K(t,e,s.id,s.name)}function xt(t,e){h.value=e,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(e))}function ht(t,e,s){h.value&&!s.user_id&&(U.value=`${t}-${e}`)}function kt(t,e){U.value===`${t}-${e}`&&(U.value=null)}async function $t(t,e){h.value&&U.value===`${t}-${e}`&&(await K(t,e,h.value.user_id,h.value.user_name,h.value.id),w.value[t].waiting_list=w.value[t].waiting_list.filter(s=>s.id!==h.value.id)),h.value=null,U.value=null}async function Ct(){const t=Object.keys(w.value).sort();let e="";if(t.length>0){const s=w.value[t[0]].date_info.display,n=w.value[t[t.length-1]].date_info.display;e=` (${s} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${X.value}ã€${e} çš„é ç´„æé†’å—ï¼Ÿ`)){j.value=!0;try{const n=(await m.post("/api/admin/send_appointment_reminders",{type:"week",offset:y.value})).data;d(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(F.value=!0)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{j.value=!1}}}async function St(t,e){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${e} çš„é ç´„æé†’å—ï¼Ÿ`)){R.value[t]=!0;try{const n=(await m.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(I.value[t]=!0),d(`âœ… å·²ç™¼é€ ${e} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{R.value[t]=!1}}}function Mt(){const{appointment:t,date:e,time:s}=W.value;Ut(t,e,s),closeReplyModal()}async function Ut(t,e,s){const n=Object.values(w.value[e].appointments),r=n.filter(a=>a.id!==t.id&&a.user_id===t.user_id);if(r.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${e} é‚„æœ‰å…¶ä»– ${r.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){d("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const a=await m.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:e});if(a.data.status==="success")n.forEach(u=>{u.user_id===t.user_id&&(u.reply_status="å·²ç¢ºèª")}),d("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(a.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(a){d(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${a.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let c;forceStatus?c=forceStatus:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?c="å·²ç¢ºèª":c="æœªå›è¦†",d("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const a=await m.put(`/api/admin/appointments/${t.id}/reply_status`,{status:c});if(a.data.status==="success"){const u=w.value[e]?.appointments[s];u&&(u.reply_status=c,c==="å·²ç¢ºèª"&&u.last_reply?u.last_reply.confirmed=!0:c==="æœªå›è¦†"&&(u.last_reply=null)),d(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${c}ã€`,"success")}else throw new Error(a.data.message||"æ›´æ–°å¤±æ•—")}catch(a){d(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${a.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}async function At(t,e,s){d("ç¢ºèªä¸­...","info");try{const n=await m.post(`/api/admin/appointments/${t}/confirm_reply`);if(n.data.status==="success"){const r=w.value[e]?.appointments[s];r&&(r.reply_status="å·²ç¢ºèª",r.last_reply&&typeof r.last_reply=="object"&&(r.last_reply.confirmed=!0)),d("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(n.data.message||"ç¢ºèªå¤±æ•—")}catch(n){d(`âŒ ç¢ºèªå¤±æ•—: ${n.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Ot(){H.value=!0,E.value=""}function rt(){H.value=!1}async function lt(){const t=E.value.trim();if(!t){d("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}V.value=!0;try{const e=await m.post("/api/admin/users/add_manual",{name:t});if(e.data.status==="success"){const s=e.data.user;O.value.push(s),z.value=D(O.value),d(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${s.name}" å·²æ–°å¢ã€‚`,"success"),rt()}else throw new Error(e.data.message||"æ–°å¢å¤±æ•—")}catch(e){d(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${e.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{V.value=!1}}const it=t=>{t.target.closest(".tw-relative")||L()};return Tt(()=>{et(),Q.value=setInterval(gt,15e3),document.addEventListener("click",it)}),jt(()=>{clearInterval(Q.value),document.removeEventListener("click",it)}),(t,e)=>(i(),l("div",zt,[o("div",Bt,[o("div",Ft,[o("h2",It,f(X.value),1)]),o("div",Vt,[o("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:e[0]||(e[0]=s=>st(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),o("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:e[1]||(e[1]=s=>st(1))},"ä¸‹ä¸€é€± â¡ï¸"),o("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:et},"ğŸ”„ é‡æ–°è¼‰å…¥"),o("button",{class:C(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",ut.value]),onClick:Ct,disabled:j.value||!Z.value},"ğŸ“¨ "+f(wt.value),11,Jt),o("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Ot},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),e[8]||(e[8]=Rt('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),P.value?(i(),l("div",Kt,[...e[9]||(e[9]=[o("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),o("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(i(),l("div",Ht,[(i(!0),l(S,null,M(w.value,s=>(i(),l("div",{key:s.date_info.date,class:C(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",s.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[o("div",{class:C(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",s.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[o("h3",Pt,f(s.date_info.day_name),1),o("p",Zt,f(s.date_info.display),1)],2),o("div",Gt,[s.is_closed?(i(),l("div",qt,[...e[10]||(e[10]=[q(" ğŸ˜´",-1),o("br",null,null,-1),q("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(i(!0),l(S,{key:1},M(s.appointments,(n,r,c)=>(i(),l("div",{key:r,class:"tw-flex tw-items-center tw-gap-2"},[o("span",Qt,f(r),1),o("div",{class:C(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-green-400":dt(`${s.date_info.date}-${r}`)}]),onDragover:_(a=>ht(s.date_info.date,r,n),["prevent"]),onDragleave:a=>kt(s.date_info.date,r),onDrop:_(a=>$t(s.date_info.date,r),["prevent"])},[o("div",{class:C(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:a=>_t(s.date_info.date,r,c),title:n.user_name||"æœªé ç´„"},[o("span",Dt,f(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",te,[o("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:vt(n),onClick:_(a=>t.handleStatusClick(n,s.date_info.date,r),["stop"])},f(ft(n)),9,ee),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:_(a=>At(n.id,s.date_info.date,r),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,se)):v("",!0)])):v("",!0),e[11]||(e[11]=o("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,Yt),x.value===`${s.date_info.date}-${r}`?(i(),l("div",ne,[b.value===1?(i(),l("div",oe,[k.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:_(a=>K(s.date_info.date,r,k.value.id,k.value.name),["stop"])}," â¡ï¸ åŒä¸Š ("+f(k.value.name)+") ",9,re)):v("",!0),o("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:_(a=>K(s.date_info.date,r,"","-- æœªé ç´„ --"),["stop"])},"-- æœªé ç´„ --",8,le),(i(!0),l(S,null,M(Y.value,a=>(i(),l("div",{key:a,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:_(u=>nt(a),["stop"])},f(a),9,ie))),128))])):v("",!0),b.value===2?(i(),l("div",ae,[o("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:e[2]||(e[2]=_(a=>b.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(S,null,M(B.value,a=>(i(),l("div",{key:a.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:_(u=>ot(s.date_info.date,r,a),["stop"])},f(a.name),9,we))),128))])):v("",!0)])):v("",!0)],42,Xt)]))),128))]),s.is_closed?v("",!0):(i(),l("div",ue,[e[12]||(e[12]=o("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),o("div",de,[!s.waiting_list||s.waiting_list.length===0?(i(),l("div",ce,"å°šç„¡å‚™å–")):v("",!0),(i(!0),l(S,null,M(s.waiting_list,n=>(i(),l("div",{key:n.id,class:"tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab",draggable:"true",onDragstart:r=>xt(r,n)},[o("span",null,f(n.user_name),1),o("button",{onClick:r=>bt(n.id,s.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,fe)],40,pe))),128))]),o("div",ve,[o("button",{onClick:n=>mt(s.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,ge),x.value===`waiting-${s.date_info.date}`?(i(),l("div",_e,[b.value===1?(i(),l("div",me,[(i(!0),l(S,null,M(Y.value,n=>(i(),l("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:_(r=>nt(n),["stop"])},f(n),9,ye))),128))])):v("",!0),b.value===2?(i(),l("div",be,[o("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:e[3]||(e[3]=_(n=>b.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(S,null,M(B.value,n=>(i(),l("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:_(r=>ot(s.date_info.date,null,n),["stop"])},f(n.name),9,xe))),128))])):v("",!0)])):v("",!0)])])),s.is_closed?v("",!0):(i(),l("button",{key:1,class:C(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",pt(s)]),onClick:n=>St(s.date_info.date,s.date_info.day_name),disabled:R.value[s.date_info.date]||!J(s)},f(ct(s)),11,he))],2))),128))])),T.value.show?(i(),l("div",{key:2,class:C(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",T.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},f(T.value.message),3)):v("",!0),H.value?(i(),l("div",ke,[o("div",$e,[e[13]||(e[13]=o("h3",{class:"tw-text-lg tw-font-bold tw-mb-4"},"æ–°å¢è‡¨æ™‚ç”¨æˆ¶",-1)),Et(o("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>E.value=s),placeholder:"è«‹è¼¸å…¥ç”¨æˆ¶å§“å",class:"tw-mt-1 tw-block tw-w-full tw-px-3 tw-py-2 tw-border tw-border-gray-300 tw-rounded-md tw-shadow-sm focus:tw-outline-none focus:tw-ring-indigo-500 focus:tw-border-indigo-500 sm:tw-text-sm",onKeyup:Lt(lt,["enter"])},null,544),[[Wt,E.value]]),o("div",Ce,[o("button",{onClick:rt,class:"tw-px-4 tw-py-2 tw-bg-gray-300 tw-text-gray-800 tw-rounded-md hover:tw-bg-gray-400"}," å–æ¶ˆ "),o("button",{onClick:lt,disabled:V.value||!E.value.trim(),class:"tw-px-4 tw-py-2 tw-bg-indigo-600 tw-text-white tw-rounded-md hover:tw-bg-indigo-700 disabled:tw-opacity-50 disabled:tw-cursor-not-allowed"},[V.value?(i(),l("span",Me,"æ–°å¢ä¸­...")):(i(),l("span",Ue,"ç¢ºå®šæ–°å¢"))],8,Se)])])])):v("",!0),W.value.show?(i(),l("div",{key:4,class:"tw-fixed tw-inset-0 tw-bg-gray-600 tw-bg-opacity-50 tw-overflow-y-auto tw-h-full tw-w-full tw-z-50 tw-flex tw-justify-center tw-items-center",onClick:e[7]||(e[7]=_((...s)=>t.closeReplyModal&&t.closeReplyModal(...s),["self"]))},[o("div",Ae,[e[16]||(e[16]=o("h3",{class:"tw-text-lg tw-font-bold tw-mb-4"},"ç”¨æˆ¶å›è¦†å…§å®¹",-1)),o("div",Oe,[o("p",Te,[e[14]||(e[14]=q("é¡å‹: ",-1)),o("span",je,f(W.value.type),1)]),e[15]||(e[15]=o("p",{class:"tw-text-sm tw-text-gray-500 tw-mt-1"},"å…§å®¹:",-1)),o("p",Re,f(W.value.content),1)]),o("div",Ee,[o("button",{onClick:e[5]||(e[5]=(...s)=>t.closeReplyModal&&t.closeReplyModal(...s)),class:"tw-px-4 tw-py-2 tw-bg-gray-300 tw-text-gray-800 tw-rounded-md hover:tw-bg-gray-400"}," é—œé–‰ "),W.value.isConfirmed?(i(),l("button",{key:1,onClick:Mt,class:"tw-px-4 tw-py-2 tw-bg-red-600 tw-text-white tw-rounded-md hover:tw-bg-red-700"}," ğŸ”„ æ¨™ç¤ºç‚ºæœªå›è¦† ")):(i(),l("button",{key:0,onClick:e[6]||(e[6]=(...s)=>t.confirmFromModal&&t.confirmFromModal(...s)),class:"tw-px-4 tw-py-2 tw-bg-green-600 tw-text-white tw-rounded-md hover:tw-bg-green-700"}," âœ… ç¢ºèªå›è¦† "))])])])):v("",!0)]))}};Nt(We).mount("#app");
