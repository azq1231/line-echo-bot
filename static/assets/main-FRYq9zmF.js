const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddManualUserModal-C68F9x-8.js","assets/runtime-dom.esm-bundler-DLYAdE7D.js","assets/ReplyContentModal-BDcn3cye.js"])))=>i.map(i=>d[i]);
import{r as d,c as P,o as zt,a as Ft,b as a,d as u,e as w,f as b,g as wt,h as It,t as m,n as A,F as N,i as j,j as ct,w as $,u as dt,k as ft,l as qt}from"./runtime-dom.esm-bundler-DLYAdE7D.js";import{a as S}from"./index-R-lXtGyY.js";const Ht="modulepreload",Zt=function(q){return"/"+q},pt={},vt=function(H,B,x){let E=Promise.resolve();if(B&&B.length>0){let k=function(g){return Promise.all(g.map(y=>Promise.resolve(y).then(C=>({status:"fulfilled",value:C}),C=>({status:"rejected",reason:C}))))};document.getElementsByTagName("link");const f=document.querySelector("meta[property=csp-nonce]"),p=f?.nonce||f?.getAttribute("nonce");E=k(B.map(g=>{if(g=Zt(g),g in pt)return;pt[g]=!0;const y=g.endsWith(".css"),C=y?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${C}`))return;const h=document.createElement("link");if(h.rel=y?"stylesheet":Ht,y||(h.as="script"),h.crossOrigin="",h.href=g,p&&h.setAttribute("nonce",p),document.head.appendChild(h),y)return new Promise((M,W)=>{h.addEventListener("load",M),h.addEventListener("error",()=>W(new Error(`Unable to preload CSS for ${g}`)))})}))}function l(f){const p=new Event("vite:preloadError",{cancelable:!0});if(p.payload=f,window.dispatchEvent(p),!p.defaultPrevented)throw f}return E.then(f=>{for(const p of f||[])p.status==="rejected"&&l(p.reason);return H().catch(l)})},Gt={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},Kt={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},Qt={class:"tw-text-center tw-mb-4"},Xt={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},Yt={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},Dt=["disabled"],te={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},ee={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},se={class:"tw-text-base tw-font-bold"},ne={class:"tw-text-sm tw-opacity-90"},re={class:"tw-flex-grow tw-space-y-1"},oe={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},le={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},ie=["onDragover","onDragleave","onDrop"],ae=["onClick","title"],ue={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},we={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},ce=["title","onClick"],de=["onClick"],fe={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mt-1"},pe={key:0},ve=["onClick"],_e=["onClick"],ge=["onClick"],me={key:1},ye=["onClick"],he={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},be={class:"tw-space-y-1 tw-text-sm"},xe={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},ke=["onDragstart"],$e=["onClick"],Ce={class:"tw-relative tw-mt-2"},Se=["onClick"],Ee={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},Oe={key:0},Ue=["onClick"],Ae={key:1},Me=["onClick"],Te=["onClick","disabled"],Re={__name:"App",setup(q){const H=ft(()=>vt(()=>import("./AddManualUserModal-C68F9x-8.js"),__vite__mapDeps([0,1]))),B=ft(()=>vt(()=>import("./ReplyContentModal-BDcn3cye.js"),__vite__mapDeps([2,1]))),x=d([]),E=d({}),l=d({}),f=d(0),p=d(null),k=d(1),g=d([]),y=d(null),C=d({show:!1,message:"",type:"info"}),h=d(!1),M=d({}),W=d(!1),V=d({}),T=d(null),R=d(null),Z=d(!1),G=d(!1),O=d({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,time:null}),K=d(!0),Y=d(null),D=P(()=>f.value===0?"æœ¬é€±é ç´„":f.value===1?"ä¸‹é€±é ç´„":f.value===-1?"ä¸Šé€±é ç´„":f.value>1?`æœªä¾†ç¬¬ ${f.value} é€±`:`éå»ç¬¬ ${Math.abs(f.value)} é€±`),_t=P(()=>{const t=new Map;return x.value.forEach(s=>{s&&s.id!==void 0&&s.id!==null&&t.set(s.id.toString(),s)}),t}),tt=P(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(E.value).sort((s,e)=>s==="#"?1:e==="#"?-1:t.indexOf(s)-t.indexOf(e))}),Q=P(()=>{for(const t in l.value)if(z(l.value[t]))return!0;return!1}),gt=P(()=>h.value?"ç™¼é€ä¸­...":W.value?"æœ¬é€±æé†’å·²ç™¼é€":Q.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),mt=P(()=>h.value?"tw-bg-gray-400 tw-text-white":Q.value?W.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function yt(t){return R.value===t}function z(t){if(!t||t.is_closed||!t.appointments)return!1;for(const s in t.appointments){const e=t.appointments[s];if(e.user_id){const n=_t.value.get(e.user_id.toString());if(n&&n.line_user_id&&n.line_user_id.startsWith("U"))return!0}}return!1}function ht(t){const s=t.date_info.date;return M.value[s]?"ç™¼é€ä¸­...":V.value[s]?"æœ¬æ—¥æé†’å·²ç™¼é€":z(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function bt(t){const s=t.date_info.date;return M.value[s]?"tw-bg-gray-400 tw-text-white":z(t)?V.value[s]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const xt=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},kt=t=>{let s="æœªçŸ¥",e="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";s=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,e=t.last_reply.content||"N/A"}else t.reply_status&&(s=t.reply_status,e=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${s}
å…§å®¹: ${e}`};function c(t,s="success",e=3e3){C.value={show:!0,message:t,type:s},setTimeout(()=>{C.value.show=!1},e)}function F(t){return t.reduce((e,n)=>{const r=n.zhuyin?n.zhuyin[0]:"#";return e[r]||(e[r]=[]),e[r].push(n),e},{})}async function et(){K.value=!0;try{const t=await S.get(`/api/admin/get_week_appointments?offset=${f.value}`);x.value=t.data.users||[],E.value=F(x.value),l.value=t.data.week_schedule||{},c("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){c("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{K.value=!1}}async function $t(){try{const s=(await S.get(`/api/admin/get_week_appointments?offset=${f.value}`)).data,e=s.week_schedule||{},n=s.users||[];JSON.stringify(x.value)!==JSON.stringify(n)&&(x.value=n,E.value=F(x.value));for(const r in l.value){const _=l.value[r],o=e[r];_&&o&&(new Set([...Object.keys(_.appointments),...Object.keys(o.appointments)]).forEach(v=>{const U=_.appointments[v],L=o.appointments[v];L&&JSON.stringify(U)!==JSON.stringify(L)?_.appointments[v]={...L}:!L&&U&&U.user_id&&(_.appointments[v]={id:U.id,user_id:null,user_name:null,reply_status:"æœªå›è¦†",last_reply:null})}),JSON.stringify(_.waiting_list)!==JSON.stringify(o.waiting_list)&&(_.waiting_list=o.waiting_list))}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function st(){c("è¼‰å…¥ä¸­...","info"),await et()}function nt(t){f.value+=t,W.value=!1,V.value={},et()}function J(){p.value=null,k.value=1,g.value=[]}function Ct(t,s,e){const n=`${t}-${s}`;if(p.value===n)J(),y.value=null;else if(p.value=n,k.value=1,y.value=null,e>0){const r=l.value[t];if(r&&r.appointments){const o=Object.keys(r.appointments)[e-1],i=r.appointments[o];i&&i.user_id&&(y.value={id:i.user_id,name:i.user_name})}}}function St(t){const s=`waiting-${t}`;p.value===s?J():(p.value=s,k.value=1)}function rt(t){g.value=E.value[t]||[],k.value=2}async function I(t,s,e,n,r=null){const _=l.value[t]?.appointments[s]?.user_id,o=l.value[t]?.appointments[s]?.user_name;if(J(),l.value[t]&&l.value[t].appointments[s]){const i=l.value[t].appointments[s];i.user_id=e,i.user_name=n,!_&&e?(i.id=Date.now(),i.reply_status="æœªå›è¦†"):_&&!e&&(i.id=null,i.reply_status="æœªå›è¦†",i.last_reply="")}c("å„²å­˜ä¸­...","info");try{const i=await S.post("/api/admin/save_appointment",{date:t,time:s,user_id:e,user_name:n,waiting_list_item_id:typeof r=="number"?r:null});if(i.data.status==="success"){c("âœ… é ç´„å·²å„²å­˜","success");const v=i.data.appointment;if(v&&l.value[t]&&l.value[t].appointments[s]){r&&(x.value=x.value.filter(L=>L.id!==e),E.value=F(x.value));const U=l.value[t].appointments[s];U.id=v.id,U.reply_status=v.reply_status,U.last_reply=v.last_reply}return!0}else throw new Error(i.data.message||"å„²å­˜å¤±æ•—")}catch(i){return c(`âŒ å„²å­˜å¤±æ•—: ${i.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),l.value[t]&&l.value[t].appointments[s]&&(l.value[t].appointments[s].user_id=_,l.value[t].appointments[s].user_name=o),!1}}async function Et(t,s){J(),c("æ–°å¢å‚™å–ä¸­...","info");try{const e=await S.post("/api/admin/waiting_list",{date:t,user_id:s.id,user_name:s.name});if(e.data.status==="success")l.value[t].waiting_list||(l.value[t].waiting_list=[]),l.value[t].waiting_list.push(e.data.item),c("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(e.data.message||"æ–°å¢å¤±æ•—")}catch(e){c(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${e.message}`,"error")}}async function Ot(t,s){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await S.delete(`/api/admin/waiting_list/${t}`);const e=l.value[s];e&&e.waiting_list&&(e.waiting_list=e.waiting_list.filter(n=>n.id!==t)),c("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{c("âŒ ç§»é™¤å¤±æ•—","error")}}function ot(t,s,e){p.value.startsWith("waiting-")?Et(t,e):I(t,s,e.id,e.name)}function Ut(t,s){T.value=s,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(s))}function At(){setTimeout(()=>{T.value=null,R.value=null},50)}function Mt(t,s,e){T.value&&!e.user_id&&(R.value=`${t}-${s}`)}function Tt(t,s){R.value===`${t}-${s}`&&(R.value=null)}async function Rt(t,s){if(T.value&&R.value===`${t}-${s}`){const e={...T.value};R.value=null,await I(t,s,e.user_id,e.user_name,e.id)&&(l.value[t].waiting_list=l.value[t].waiting_list.filter(r=>r.id!==e.id))}}async function Nt(){const t=Object.keys(l.value).sort();let s="";if(t.length>0){const e=l.value[t[0]].date_info.display,n=l.value[t[t.length-1]].date_info.display;s=` (${e} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${D.value}ã€${s} çš„é ç´„æé†’å—ï¼Ÿ`)){h.value=!0;try{const n=(await S.post("/api/admin/send_appointment_reminders",{type:"week",offset:f.value})).data;c(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(W.value=!0)}catch{c("âŒ ç™¼é€å¤±æ•—","error")}finally{h.value=!1}}}async function jt(t,s){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${s} çš„é ç´„æé†’å—ï¼Ÿ`)){M.value[t]=!0;try{const n=(await S.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(V.value[t]=!0),c(`âœ… å·²ç™¼é€ ${s} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{c("âŒ ç™¼é€å¤±æ•—","error")}finally{M.value[t]=!1}}}function Wt(){const{appointment:t,date:s,time:e}=O.value;lt(t,s,e,"æœªå›è¦†"),X()}async function lt(t,s,e,n=null){const r=Object.values(l.value[s].appointments),_=r.filter(i=>i.id!==t.id&&i.user_id===t.user_id);if(_.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${s} é‚„æœ‰å…¶ä»– ${_.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){c("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const i=await S.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:s});if(i.data.status==="success")r.forEach(v=>{v.user_id===t.user_id&&(v.reply_status="å·²ç¢ºèª")}),c("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(i.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(i){c(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${i.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let o;n?o=n:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?o="å·²ç¢ºèª":o="æœªå›è¦†",c("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const i=await S.put(`/api/admin/appointments/${t.id}/reply_status`,{status:o});if(i.data.status==="success"){const v=l.value[s]?.appointments[e];v&&(v.reply_status=o,o==="å·²ç¢ºèª"&&v.last_reply?v.last_reply.confirmed=!0:o==="æœªå›è¦†"&&(v.last_reply=null)),c(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${o}ã€`,"success")}else throw new Error(i.data.message||"æ›´æ–°å¤±æ•—")}catch(i){c(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${i.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function X(){O.value.show=!1}function Lt(){const{appointment:t,date:s,time:e}=O.value;t&&t.id&&it(t.id,s,e),X()}function Pt(t,s,e){t.last_reply&&(O.value={show:!0,type:t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—",content:t.last_reply.content,isConfirmed:t.last_reply.confirmed,appointment:t,date:s,time:e})}function Bt(t,s,e){t.last_reply&&!t.last_reply.confirmed?Pt(t,s,e):lt(t,s,e)}async function it(t,s,e){c("ç¢ºèªä¸­...","info");try{const n=await S.post(`/api/admin/appointments/${t}/confirm_reply`);if(n.data.status==="success"){const r=l.value[s]?.appointments[e];r&&(r.reply_status="å·²ç¢ºèª",r.last_reply&&typeof r.last_reply=="object"&&(r.last_reply.confirmed=!0)),c("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(n.data.message||"ç¢ºèªå¤±æ•—")}catch(n){c(`âŒ ç¢ºèªå¤±æ•—: ${n.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Jt(){Z.value=!0}function at(){Z.value=!1}async function Vt(){if(!arguments[0]){c("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}G.value=!0;try{const t=await S.post("/api/admin/users/add_manual",{name:arguments[0]});if(t.data.status==="success"){const s=t.data.user;x.value.push(s),E.value=F(x.value),c(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${s.name}" å·²æ–°å¢ã€‚`,"success"),at()}else throw new Error(t.data.message||"æ–°å¢å¤±æ•—")}catch(t){c(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${t.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{G.value=!1}}const ut=t=>{const s=t.target.closest(".tw-relative"),e=t.target.closest('[draggable="true"]');!s&&!e&&J()};return zt(()=>{st(),Y.value=setInterval($t,15e3),document.addEventListener("click",ut)}),Ft(()=>{clearInterval(Y.value),document.removeEventListener("click",ut)}),(t,s)=>(u(),a("div",Gt,[w("div",Kt,[w("div",Qt,[w("h2",Xt,m(D.value),1)]),w("div",Yt,[w("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[0]||(s[0]=e=>nt(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),w("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[1]||(s[1]=e=>nt(1))},"ä¸‹ä¸€é€± â¡ï¸"),w("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:st},"ğŸ”„ é‡æ–°è¼‰å…¥"),w("button",{class:A(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",mt.value]),onClick:Nt,disabled:h.value||!Q.value},"ğŸ“¨ "+m(gt.value),11,Dt),w("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Jt},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),s[4]||(s[4]=It('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),K.value?(u(),a("div",te,[...s[5]||(s[5]=[w("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),w("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(u(),a("div",ee,[(u(!0),a(N,null,j(l.value,e=>(u(),a("div",{key:e.date_info.date,class:A(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",e.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[w("div",{class:A(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",e.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[w("h3",se,m(e.date_info.day_name),1),w("p",ne,m(e.date_info.display),1)],2),w("div",re,[e.is_closed?(u(),a("div",oe,[...s[6]||(s[6]=[ct(" ğŸ˜´",-1),w("br",null,null,-1),ct("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(u(!0),a(N,{key:1},j(e.appointments,(n,r,_)=>(u(),a("div",{key:r,class:"tw-flex tw-items-center tw-gap-2"},[w("span",le,m(r),1),w("div",{class:A(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":yt(`${e.date_info.date}-${r}`)}]),onDragover:$(o=>Mt(e.date_info.date,r,n),["prevent"]),onDragleave:o=>Tt(e.date_info.date,r),onDrop:$(o=>Rt(e.date_info.date,r),["prevent"])},[w("div",{class:A(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>Ct(e.date_info.date,r,_),title:n.user_name||"æœªé ç´„"},[w("span",ue,m(n.user_name||"-- æœªé ç´„ --"),1),n.id?(u(),a("div",we,[w("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:kt(n),onClick:$(o=>Bt(n,e.date_info.date,r),["stop"])},m(xt(n)),9,ce),n.reply_status==="å·²å›è¦†"?(u(),a("button",{key:0,onClick:$(o=>it(n.id,e.date_info.date,r),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,de)):b("",!0)])):b("",!0),s[7]||(s[7]=w("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,ae),p.value===`${e.date_info.date}-${r}`?(u(),a("div",fe,[k.value===1?(u(),a("div",pe,[y.value?(u(),a("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:$(o=>I(e.date_info.date,r,y.value.id,y.value.name),["stop"])}," â¡ï¸ åŒä¸Š ("+m(y.value.name)+") ",9,ve)):b("",!0),w("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:$(o=>I(e.date_info.date,r,"","-- æœªé ç´„ --"),["stop"])},"-- æœªé ç´„ --",8,_e),(u(!0),a(N,null,j(tt.value,o=>(u(),a("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:$(i=>rt(o),["stop"])},m(o),9,ge))),128))])):b("",!0),k.value===2?(u(),a("div",me,[w("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[2]||(s[2]=$(o=>k.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(u(!0),a(N,null,j(g.value,o=>(u(),a("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:$(i=>ot(e.date_info.date,r,o),["stop"])},m(o.name),9,ye))),128))])):b("",!0)])):b("",!0)],42,ie)]))),128))]),e.is_closed?b("",!0):(u(),a("div",he,[s[8]||(s[8]=w("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),w("div",be,[!e.waiting_list||e.waiting_list.length===0?(u(),a("div",xe,"å°šç„¡å‚™å–")):b("",!0),(u(!0),a(N,null,j(e.waiting_list,n=>(u(),a("div",{key:n.id,class:A(["tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab tw-transition-opacity",{"tw-opacity-40":T.value&&T.value.id===n.id}]),draggable:"true",onDragstart:r=>Ut(r,n),onDragend:At},[w("span",null,m(n.user_name),1),w("button",{onClick:r=>Ot(n.id,e.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,$e)],42,ke))),128))]),w("div",Ce,[w("button",{onClick:n=>St(e.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,Se),p.value===`waiting-${e.date_info.date}`?(u(),a("div",Ee,[k.value===1?(u(),a("div",Oe,[(u(!0),a(N,null,j(tt.value,n=>(u(),a("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:$(r=>rt(n),["stop"])},m(n),9,Ue))),128))])):b("",!0),k.value===2?(u(),a("div",Ae,[w("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[3]||(s[3]=$(n=>k.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(u(!0),a(N,null,j(g.value,n=>(u(),a("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:$(r=>ot(e.date_info.date,null,n),["stop"])},m(n.name),9,Me))),128))])):b("",!0)])):b("",!0)])])),e.is_closed?b("",!0):(u(),a("button",{key:1,class:A(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",bt(e)]),onClick:n=>jt(e.date_info.date,e.date_info.day_name),disabled:M.value[e.date_info.date]||!z(e)},m(ht(e)),11,Te))],2))),128))])),C.value.show?(u(),a("div",{key:2,class:A(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",C.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},m(C.value.message),3)):b("",!0),wt(dt(H),{show:Z.value,"is-adding":G.value,onClose:at,onSubmit:Vt},null,8,["show","is-adding"]),wt(dt(B),{show:O.value.show,type:O.value.type,content:O.value.content,"is-confirmed":O.value.isConfirmed,onClose:X,onConfirm:Lt,onResetStatus:Wt},null,8,["show","type","content","is-confirmed"])]))}};qt(Re).mount("#app");
