const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddManualUserModal-D967k0HM.js","assets/runtime-dom.esm-bundler-wIgYT9iR.js","assets/ReplyContentModal-CRfWvUgy.js"])))=>i.map(i=>d[i]);
import{r as g,c as z,o as Qt,a as Xt,b as i,d as l,e as a,f as _,g as $t,h as Yt,t as p,n as T,F as L,i as I,j as Ct,w as c,k as St,v as Et,u as Lt,l as Ut,m as Dt}from"./runtime-dom.esm-bundler-wIgYT9iR.js";import{a as O}from"./index-R-lXtGyY.js";const te="modulepreload",ee=function(X){return"/static/"+X},It={},Ot=function(Y,V,S){let A=Promise.resolve();if(V&&V.length>0){let C=function($){return Promise.all($.map(x=>Promise.resolve(x).then(b=>({status:"fulfilled",value:b}),b=>({status:"rejected",reason:b}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),m=y?.nonce||y?.getAttribute("nonce");A=C(V.map($=>{if($=ee($),$ in It)return;It[$]=!0;const x=$.endsWith(".css"),b=x?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${$}"]${b}`))return;const E=document.createElement("link");if(E.rel=x?"stylesheet":te,x||(E.as="script"),E.crossOrigin="",E.href=$,m&&E.setAttribute("nonce",m),document.head.appendChild(E),x)return new Promise((R,M)=>{E.addEventListener("load",R),E.addEventListener("error",()=>M(new Error(`Unable to preload CSS for ${$}`)))})}))}function f(y){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=y,window.dispatchEvent(m),!m.defaultPrevented)throw y}return A.then(y=>{for(const m of y||[])m.status==="rejected"&&f(m.reason);return Y().catch(f)})},se={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},ne={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},oe={class:"tw-text-center tw-mb-4"},re={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},ie={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},le=["disabled"],ae={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},we={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},ue={class:"tw-text-base tw-font-bold"},de={class:"tw-text-sm tw-opacity-90"},ce=["onClick","disabled"],fe={class:"tw-flex-grow tw-space-y-1"},pe={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},ve={class:"tw-mb-2"},ge={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},_e=["onDragover","onDragleave","onDrop"],me=["onClick","title"],ye={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},he={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},xe=["title","onClick"],be=["onClick"],ke={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},$e={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},Ce={class:"tw-max-h-48 tw-overflow-y-auto"},Se={key:0},Ee={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Le={key:1},Ue=["onClick"],Ie=["onClick"],Oe={key:1},Te={key:0},Ae=["onClick"],Me=["onClick"],Fe=["onClick"],Ne={key:1},Re=["onClick"],We={class:"tw-mt-3"},je={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},ze=["onDragover","onDragleave","onDrop"],Pe=["onClick","title"],Ve={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},Be={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},Je=["title","onClick"],qe=["onClick"],He={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-64 tw-overflow-hidden tw-z-10 tw-shadow-lg tw-mt-1"},Ke={class:"tw-sticky tw-top-0 tw-bg-white tw-border-b tw-border-gray-200 tw-p-2"},Ze={class:"tw-max-h-48 tw-overflow-y-auto"},Ge={key:0},Qe={key:0,class:"tw-px-2.5 tw-py-3 tw-text-sm tw-text-gray-500 tw-text-center"},Xe={key:1},Ye=["onClick"],De=["onClick"],ts={key:1},es={key:0},ss=["onClick"],ns=["onClick"],os=["onClick"],rs={key:1},is=["onClick"],ls={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},as={class:"tw-space-y-1 tw-text-sm"},ws={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},us=["onDragstart"],ds=["onClick"],cs={class:"tw-relative tw-mt-2"},fs=["onClick"],ps={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},vs={key:0},gs=["onClick"],_s={key:1},ms=["onClick"],ys=["onClick","disabled"],hs={__name:"App",setup(X){const Y=Ut(()=>Ot(()=>import("./AddManualUserModal-D967k0HM.js"),__vite__mapDeps([0,1]))),V=Ut(()=>Ot(()=>import("./ReplyContentModal-CRfWvUgy.js"),__vite__mapDeps([2,1]))),S=g([]),A=g({}),f=g({}),y=g(0),m=g(null),C=g(1),$=g([]),x=g(""),b=g(null),E=g({show:!1,message:"",type:"info"}),R=g(!1),M=g({}),H=g(!1),B=g({}),W=g(null),j=g(null),D=g(!1),tt=g(!1),F=g({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,appointment:null,date:null,time:null,type:"consultation"}),et=g(!0),lt=g(null),at=z(()=>y.value===0?"æœ¬é€±é ç´„":y.value===1?"ä¸‹é€±é ç´„":y.value===-1?"ä¸Šé€±é ç´„":y.value>1?`æœªä¾†ç¬¬ ${y.value} é€±`:`éå»ç¬¬ ${Math.abs(y.value)} é€±`),Tt=z(()=>{const t=new Map;return S.value.forEach(s=>{s&&s.id!==void 0&&s.id!==null&&t.set(s.id.toString(),s)}),t}),st=z(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(A.value).sort((s,e)=>s==="#"?1:e==="#"?-1:t.indexOf(s)-t.indexOf(e))}),K=z(()=>{if(!x.value.trim())return S.value;const t=x.value.toLowerCase();return S.value.filter(s=>s.name.toLowerCase().includes(t)||s.zhuyin&&s.zhuyin.toLowerCase().includes(t))}),nt=z(()=>{for(const t in f.value)if(Z(f.value[t]))return!0;return!1}),At=z(()=>R.value?"ç™¼é€ä¸­...":H.value?"æœ¬é€±æé†’å·²ç™¼é€":nt.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),Mt=z(()=>R.value?"tw-bg-gray-400 tw-text-white":nt.value?H.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function wt(t){return j.value===t}function Z(t){if(!t||t.is_closed)return!1;const s=e=>{if(!e)return!1;for(const n in e){const r=e[n];if(r.user_id){const u=Tt.value.get(r.user_id.toString());if(u&&u.line_user_id&&u.line_user_id.startsWith("U"))return!0}}return!1};return s(t.appointments)||s(t.appointments_massage)}function Ft(t){const s=t.date_info.date;return M.value[s]?"ç™¼é€ä¸­...":B.value[s]?"æœ¬æ—¥æé†’å·²ç™¼é€":Z(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function Nt(t){const s=t.date_info.date;return M.value[s]?"tw-bg-gray-400 tw-text-white":Z(t)?B.value[s]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const ut=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},dt=t=>{let s="æœªçŸ¥",e="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";s=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,e=t.last_reply.content||"N/A"}else t.reply_status&&(s=t.reply_status,e=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${s}
å…§å®¹: ${e}`};function d(t,s="success",e=3e3){E.value={show:!0,message:t,type:s},setTimeout(()=>{E.value.show=!1},e)}function G(t){return t.reduce((e,n)=>{const r=n.zhuyin?n.zhuyin[0]:"#";return e[r]||(e[r]=[]),e[r].push(n),e},{})}async function ct(){et.value=!0;try{const t=await O.get(`/api/admin/get_week_appointments?offset=${y.value}`);S.value=t.data.users||[],A.value=G(S.value),f.value=t.data.week_schedule||{},d("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){d("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{et.value=!1}}async function Rt(){try{const s=(await O.get(`/api/admin/get_week_appointments?offset=${y.value}`)).data,e=s.week_schedule||{},n=s.users||[];JSON.stringify(S.value)!==JSON.stringify(n)&&(S.value=n,A.value=G(S.value));for(const r in f.value){const u=f.value[r],o=e[r];if(u&&o){const v=(U,w)=>{if(!U)return;new Set([...Object.keys(U),...Object.keys(w||{})]).forEach(k=>{const P=U[k],Q=w?w[k]:null;Q&&JSON.stringify(P)!==JSON.stringify(Q)?U[k]={...Q}:!Q&&P&&P.user_id&&(U[k]={id:P.id,user_id:null,user_name:null,reply_status:"æœªå›è¦†",last_reply:null})})};v(u.appointments,o.appointments),u.appointments_massage||(u.appointments_massage={}),v(u.appointments_massage,o.appointments_massage),JSON.stringify(u.waiting_list)!==JSON.stringify(o.waiting_list)&&(u.waiting_list=o.waiting_list)}}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function ft(){d("è¼‰å…¥ä¸­...","info"),await ct()}function pt(t){y.value+=t,H.value=!1,B.value={},ct()}function J(){m.value=null,C.value=1,$.value=[],x.value=""}function vt(t,s,e,n="consultation"){const r=`${t}-${s}-${n}`;if(m.value===r)J(),b.value=null;else if(m.value=r,C.value=1,x.value="",b.value=null,e>0){const u=f.value[t],o=n==="massage"?u.appointments_massage:u.appointments;if(u&&o){const U=Object.keys(o).sort()[e-1],w=o[U];w&&w.user_id&&(b.value={id:w.user_id,name:w.user_name})}}}function Wt(t){const s=`waiting-${t}`;m.value===s?J():(m.value=s,C.value=1)}function ot(t){$.value=A.value[t]||[],C.value=2}async function N(t,s,e,n,r=null,u="consultation"){const o=u==="massage"?f.value[t]?.appointments_massage:f.value[t]?.appointments,v=o?.[s]?.user_id,U=o?.[s]?.user_name;if(J(),f.value[t]&&o?.[s]){const w=o[s];w.user_id=e,w.user_name=n,!v&&e?(w.id=Date.now(),w.reply_status="æœªå›è¦†"):v&&!e&&(w.id=null,w.reply_status="æœªå›è¦†",w.last_reply="")}d("å„²å­˜ä¸­...","info");try{const w=await O.post("/api/admin/save_appointment",{date:t,time:s,user_id:e,user_name:n,waiting_list_item_id:r?Number(r):null,type:u});if(w.data.status==="success"){d("âœ… é ç´„å·²å„²å­˜","success");const h=w.data.appointment;if(h&&f.value[t]&&o?.[s]){const k=o[s];k.id=h.id,k.reply_status=h.reply_status,k.last_reply=h.last_reply,r&&(S.value=S.value.filter(P=>P.id!==e),A.value=G(S.value))}return!0}else throw new Error(w.data.message||"å„²å­˜å¤±æ•—")}catch(w){return d(`âŒ å„²å­˜å¤±æ•—: ${w.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),f.value[t]&&o?.[s]&&(o[s].user_id=v,o[s].user_name=U),!1}}async function jt(t,s){J(),d("æ–°å¢å‚™å–ä¸­...","info");try{const e=await O.post("/api/admin/waiting_list",{date:t,user_id:s.id,user_name:s.name});if(e.data.status==="success")f.value[t].waiting_list||(f.value[t].waiting_list=[]),f.value[t].waiting_list.push(e.data.item),d("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(e.data.message||"æ–°å¢å¤±æ•—")}catch(e){d(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${e.message}`,"error")}}async function zt(t,s){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await O.delete(`/api/admin/waiting_list/${t}`);const e=f.value[s];e&&e.waiting_list&&(e.waiting_list=e.waiting_list.filter(n=>n.id!==t)),d("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{d("âŒ ç§»é™¤å¤±æ•—","error")}}function q(t,s,e,n="consultation"){m.value.startsWith("waiting-")?jt(t,e):N(t,s,e.id,e.name,null,n)}function Pt(t,s){W.value=s,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(s))}function Vt(){setTimeout(()=>{W.value=null,j.value=null},50)}function gt(t,s,e,n="consultation"){W.value&&!e.user_id&&(j.value=`${t}-${s}-${n}`)}function _t(t,s,e="consultation"){j.value===`${t}-${s}-${e}`&&(j.value=null)}async function mt(t,s,e="consultation"){if(W.value&&j.value===`${t}-${s}-${e}`){const n={...W.value};j.value=null,await N(t,s,n.user_id,n.user_name,n.id,e)&&(f.value[t].waiting_list=f.value[t].waiting_list.filter(u=>u.id!==n.id))}}async function Bt(){const t=Object.keys(f.value).sort();let s="";if(t.length>0){const e=f.value[t[0]].date_info.display,n=f.value[t[t.length-1]].date_info.display;s=` (${e} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${at.value}ã€${s} çš„é ç´„æé†’å—ï¼Ÿ`)){R.value=!0;try{const n=(await O.post("/api/admin/send_appointment_reminders",{type:"week",offset:y.value})).data;d(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(H.value=!0)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{R.value=!1}}}async function yt(t,s){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${s} çš„é ç´„æé†’å—ï¼Ÿ`)){M.value[t]=!0;try{const n=(await O.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(B.value[t]=!0),d(`âœ… å·²ç™¼é€ ${s} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{M.value[t]=!1}}}function Jt(){const{appointment:t,date:s,time:e,type:n}=F.value;ht(t,s,e,n,"æœªå›è¦†"),rt()}async function ht(t,s,e,n="consultation",r=null){const u=f.value[s],o=n==="massage"?u.appointments_massage:u.appointments,v=Object.values(o),U=v.filter(h=>h.id!==t.id&&h.user_id===t.user_id);if(U.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${s} é‚„æœ‰å…¶ä»– ${U.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){d("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const h=await O.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:s});if(h.data.status==="success")v.forEach(k=>{k.user_id===t.user_id&&(k.reply_status="å·²ç¢ºèª")}),d("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(h.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(h){d(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let w;r?w=r:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?w="å·²ç¢ºèª":w="æœªå›è¦†",d("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const h=await O.put(`/api/admin/appointments/${t.id}/reply_status`,{status:w});if(h.data.status==="success"){const k=o[e];k&&(k.reply_status=w,w==="å·²ç¢ºèª"&&k.last_reply?k.last_reply.confirmed=!0:w==="æœªå›è¦†"&&(k.last_reply=null)),d(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${w}ã€`,"success")}else throw new Error(h.data.message||"æ›´æ–°å¤±æ•—")}catch(h){d(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${h.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function rt(){F.value.show=!1}function qt(){const{appointment:t,date:s,time:e,type:n}=F.value;t&&t.id&&it(t.id,s,e,n),rt()}function Ht(t,s,e,n="consultation"){t.last_reply&&(F.value={show:!0,type:t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—",content:t.last_reply.content,isConfirmed:t.last_reply.confirmed,appointment:t,date:s,time:e,type:n})}function xt(t,s,e,n="consultation"){t.last_reply&&!t.last_reply.confirmed?Ht(t,s,e,n):ht(t,s,e,n)}async function it(t,s,e,n="consultation"){d("ç¢ºèªä¸­...","info");try{const r=await O.post(`/api/admin/appointments/${t}/confirm_reply`);if(r.data.status==="success"){const u=f.value[s],v=(n==="massage"?u.appointments_massage:u.appointments)?.[e];v&&(v.reply_status="å·²ç¢ºèª",v.last_reply&&typeof v.last_reply=="object"&&(v.last_reply.confirmed=!0)),d("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(r.data.message||"ç¢ºèªå¤±æ•—")}catch(r){d(`âŒ ç¢ºèªå¤±æ•—: ${r.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Kt(){D.value=!0}function bt(){D.value=!1}async function Zt(){if(!arguments[0]){d("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}tt.value=!0;try{const t=await O.post("/api/admin/users/add_manual",{name:arguments[0]});if(t.data.status==="success"){const s=t.data.user;S.value.push(s),A.value=G(S.value),d(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${s.name}" å·²æ–°å¢ã€‚`,"success"),bt()}else throw new Error(t.data.message||"æ–°å¢å¤±æ•—")}catch(t){d(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${t.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{tt.value=!1}}const kt=t=>{const s=t.target.closest(".tw-relative"),e=t.target.closest('[draggable="true"]');!s&&!e&&J()};async function Gt(){try{console.warn("VITE_LIFF_ID is not defined. LIFF initialization skipped.");return}catch(t){console.error("LIFF initialization failed:",t)}}return Qt(()=>{Gt(),ft(),lt.value=setInterval(Rt,15e3),document.addEventListener("click",kt)}),Xt(()=>{clearInterval(lt.value),document.removeEventListener("click",kt)}),(t,s)=>(l(),i("div",se,[a("div",ne,[a("div",oe,[a("h2",re,p(at.value),1)]),a("div",ie,[a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[0]||(s[0]=e=>pt(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[1]||(s[1]=e=>pt(1))},"ä¸‹ä¸€é€± â¡ï¸"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:ft},"ğŸ”„ é‡æ–°è¼‰å…¥"),a("button",{class:T(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",Mt.value]),onClick:Bt,disabled:R.value||!nt.value},"ğŸ“¨ "+p(At.value),11,le),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Kt},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),s[9]||(s[9]=Yt('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),et.value?(l(),i("div",ae,[...s[10]||(s[10]=[a("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),a("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(l(),i("div",we,[(l(!0),i(L,null,I(f.value,e=>(l(),i("div",{key:e.date_info.date,class:T(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",e.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[a("div",{class:T(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",e.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[a("h3",ue,p(e.date_info.day_name),1),a("p",de,p(e.date_info.display),1),e.is_closed?_("",!0):(l(),i("button",{key:0,class:"tw-mt-2 tw-px-2 tw-py-1 tw-text-xs tw-bg-white/20 hover:tw-bg-white/30 tw-text-white tw-rounded tw-transition",onClick:n=>yt(e.date_info.date,e.date_info.day_name),disabled:M.value[e.date_info.date]},p(B.value[e.date_info.date]?"å·²ç™¼é€":"ç™¼é€æé†’"),9,ce))],2),a("div",fe,[e.is_closed?(l(),i("div",pe,[...s[11]||(s[11]=[Ct(" ğŸ˜´",-1),a("br",null,null,-1),Ct("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(l(),i(L,{key:1},[a("div",ve,[s[13]||(s[13]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"çœ‹è¨ºæ™‚æ®µ",-1)),(l(!0),i(L,null,I(e.appointments,(n,r,u)=>(l(),i("div",{key:"consultation-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",ge,p(r),1),a("div",{class:T(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":wt(`${e.date_info.date}-${r}-consultation`)}]),onDragover:c(o=>gt(e.date_info.date,r,n,"consultation"),["prevent"]),onDragleave:o=>_t(e.date_info.date,r,"consultation"),onDrop:c(o=>mt(e.date_info.date,r,"consultation"),["prevent"])},[a("div",{class:T(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(e.date_info.date,r,u,"consultation"),title:n.user_name||"æœªé ç´„"},[a("span",ye,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(l(),i("div",he,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>xt(n,e.date_info.date,r,"consultation"),["stop"])},p(ut(n)),9,xe),n.reply_status==="å·²å›è¦†"?(l(),i("button",{key:0,onClick:c(o=>it(n.id,e.date_info.date,r,"consultation"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,be)):_("",!0)])):_("",!0),s[12]||(s[12]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,me),m.value===`${e.date_info.date}-${r}-consultation`?(l(),i("div",ke,[a("div",$e,[St(a("input",{"onUpdate:modelValue":s[2]||(s[2]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:s[3]||(s[3]=c(()=>{},["stop"])),ref_for:!0,ref:"searchInput"},null,512),[[Et,x.value]])]),a("div",Ce,[x.value.trim()?(l(),i("div",Se,[K.value.length===0?(l(),i("div",Ee," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(l(),i("div",Le,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Ue),(l(!0),i(L,null,I(K.value,o=>(l(),i("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>q(e.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,Ie))),128))]))])):(l(),i("div",Oe,[C.value===1?(l(),i("div",Te,[b.value?(l(),i("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,b.value.id,b.value.name,null,"consultation"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,Ae)):_("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,Me),(l(!0),i(L,null,I(st.value,o=>(l(),i("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,Fe))),128))])):_("",!0),C.value===2?(l(),i("div",Ne,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[4]||(s[4]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(l(!0),i(L,null,I($.value,o=>(l(),i("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>q(e.date_info.date,r,o,"consultation"),["stop"])},p(o.name),9,Re))),128))])):_("",!0)]))])])):_("",!0)],42,_e)]))),128))]),a("div",We,[s[15]||(s[15]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"æ¨æ‹¿æ™‚æ®µ",-1)),(l(!0),i(L,null,I(e.appointments_massage,(n,r,u)=>(l(),i("div",{key:"massage-"+r,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",je,p(r),1),a("div",{class:T(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":wt(`${e.date_info.date}-${r}-massage`)}]),onDragover:c(o=>gt(e.date_info.date,r,n,"massage"),["prevent"]),onDragleave:o=>_t(e.date_info.date,r,"massage"),onDrop:c(o=>mt(e.date_info.date,r,"massage"),["prevent"])},[a("div",{class:T(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:o=>vt(e.date_info.date,r,u,"massage"),title:n.user_name||"æœªé ç´„"},[a("span",Ve,p(n.user_name||"-- æœªé ç´„ --"),1),n.id?(l(),i("div",Be,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:dt(n),onClick:c(o=>xt(n,e.date_info.date,r,"massage"),["stop"])},p(ut(n)),9,Je),n.reply_status==="å·²å›è¦†"?(l(),i("button",{key:0,onClick:c(o=>it(n.id,e.date_info.date,r,"massage"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,qe)):_("",!0)])):_("",!0),s[14]||(s[14]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,Pe),m.value===`${e.date_info.date}-${r}-massage`?(l(),i("div",He,[a("div",Ke,[St(a("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>x.value=o),type:"text",placeholder:"ğŸ” æœå°‹ç”¨æˆ¶åç¨±...",class:"tw-w-full tw-px-2 tw-py-1.5 tw-text-sm tw-border tw-border-gray-300 tw-rounded focus:tw-outline-none focus:tw-border-indigo-500",onClick:s[6]||(s[6]=c(()=>{},["stop"]))},null,512),[[Et,x.value]])]),a("div",Ze,[x.value.trim()?(l(),i("div",Ge,[K.value.length===0?(l(),i("div",Qe," æ‰¾ä¸åˆ°ç¬¦åˆçš„ç”¨æˆ¶ ")):(l(),i("div",Xe,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,Ye),(l(!0),i(L,null,I(K.value,o=>(l(),i("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>q(e.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,De))),128))]))])):(l(),i("div",ts,[C.value===1?(l(),i("div",es,[b.value?(l(),i("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,b.value.id,b.value.name,null,"massage"),["stop"])}," â¡ï¸ åŒä¸Š ("+p(b.value.name)+") ",9,ss)):_("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(o=>N(e.date_info.date,r,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,ns),(l(!0),i(L,null,I(st.value,o=>(l(),i("div",{key:o,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>ot(o),["stop"])},p(o),9,os))),128))])):_("",!0),C.value===2?(l(),i("div",rs,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[7]||(s[7]=c(o=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(l(!0),i(L,null,I($.value,o=>(l(),i("div",{key:o.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(v=>q(e.date_info.date,r,o,"massage"),["stop"])},p(o.name),9,is))),128))])):_("",!0)]))])])):_("",!0)],42,ze)]))),128))])],64))]),e.is_closed?_("",!0):(l(),i("div",ls,[s[16]||(s[16]=a("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),a("div",as,[!e.waiting_list||e.waiting_list.length===0?(l(),i("div",ws,"å°šç„¡å‚™å–")):_("",!0),(l(!0),i(L,null,I(e.waiting_list,n=>(l(),i("div",{key:n.id,class:T(["tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab tw-transition-opacity",{"tw-opacity-40":W.value&&W.value.id===n.id}]),draggable:"true",onDragstart:r=>Pt(r,n),onDragend:Vt},[a("span",null,p(n.user_name),1),a("button",{onClick:r=>zt(n.id,e.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,ds)],42,us))),128))]),a("div",cs,[a("button",{onClick:n=>Wt(e.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,fs),m.value===`waiting-${e.date_info.date}`?(l(),i("div",ps,[C.value===1?(l(),i("div",vs,[(l(!0),i(L,null,I(st.value,n=>(l(),i("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>ot(n),["stop"])},p(n),9,gs))),128))])):_("",!0),C.value===2?(l(),i("div",_s,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[8]||(s[8]=c(n=>C.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(l(!0),i(L,null,I($.value,n=>(l(),i("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:c(r=>q(e.date_info.date,null,n),["stop"])},p(n.name),9,ms))),128))])):_("",!0)])):_("",!0)])])),e.is_closed?_("",!0):(l(),i("button",{key:1,class:T(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",Nt(e)]),onClick:n=>yt(e.date_info.date,e.date_info.day_name),disabled:M.value[e.date_info.date]||!Z(e)},p(Ft(e)),11,ys))],2))),128))])),E.value.show?(l(),i("div",{key:2,class:T(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",E.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},p(E.value.message),3)):_("",!0),$t(Lt(Y),{show:D.value,"is-adding":tt.value,onClose:bt,onSubmit:Zt},null,8,["show","is-adding"]),$t(Lt(V),{show:F.value.show,type:F.value.type,content:F.value.content,"is-confirmed":F.value.isConfirmed,onClose:rt,onConfirm:qt,onResetStatus:Jt},null,8,["show","type","content","is-confirmed"])]))}};Dt(hs).mount("#app");
