const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddManualUserModal-C68F9x-8.js","assets/runtime-dom.esm-bundler-DLYAdE7D.js","assets/ReplyContentModal-BDcn3cye.js"])))=>i.map(i=>d[i]);
import{r as g,c as J,o as qt,a as Ht,b as l,d as i,e as a,f as m,g as bt,h as Zt,t as f,n as M,F as A,i as T,j as xt,w as p,u as kt,k as $t,l as Gt}from"./runtime-dom.esm-bundler-DLYAdE7D.js";import{a as U}from"./index-R-lXtGyY.js";const Kt="modulepreload",Qt=function(G){return"/static/"+G},Ct={},St=function(K,V,S){let R=Promise.resolve();if(V&&V.length>0){let $=function(k){return Promise.all(k.map(h=>Promise.resolve(h).then(O=>({status:"fulfilled",value:O}),O=>({status:"rejected",reason:O}))))};document.getElementsByTagName("link");const y=document.querySelector("meta[property=csp-nonce]"),_=y?.nonce||y?.getAttribute("nonce");R=$(V.map(k=>{if(k=Qt(k),k in Ct)return;Ct[k]=!0;const h=k.endsWith(".css"),O=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${k}"]${O}`))return;const C=document.createElement("link");if(C.rel=h?"stylesheet":Kt,h||(C.as="script"),C.crossOrigin="",C.href=k,_&&C.setAttribute("nonce",_),document.head.appendChild(C),h)return new Promise((j,P)=>{C.addEventListener("load",j),C.addEventListener("error",()=>P(new Error(`Unable to preload CSS for ${k}`)))})}))}function c(y){const _=new Event("vite:preloadError",{cancelable:!0});if(_.payload=y,window.dispatchEvent(_),!_.defaultPrevented)throw y}return R.then(y=>{for(const _ of y||[])_.status==="rejected"&&c(_.reason);return K().catch(c)})},Xt={class:"tw-max-w-screen-2xl tw-mx-auto tw-font-sans"},Yt={class:"tw-bg-white tw-p-5 tw-rounded-lg tw-shadow-md tw-mb-5"},Dt={class:"tw-text-center tw-mb-4"},te={class:"tw-text-xl tw-font-bold tw-text-indigo-600"},ee={class:"tw-flex tw-flex-wrap tw-gap-2 tw-justify-center"},se=["disabled"],ne={key:0,class:"tw-flex tw-justify-center tw-items-center tw-py-10"},oe={key:1,class:"tw-grid tw-grid-cols-1 sm:tw-grid-cols-2 md:tw-grid-cols-3 lg:tw-grid-cols-5 tw-gap-3 tw-pb-4"},re={class:"tw-text-base tw-font-bold"},le={class:"tw-text-sm tw-opacity-90"},ie={class:"tw-flex-grow tw-space-y-1"},ae={key:0,class:"tw-flex-grow tw-flex tw-items-center tw-justify-center tw-text-center tw-text-gray-500 tw-font-bold tw-p-5 tw-bg-gray-200 tw-rounded-md"},ue={class:"tw-mb-2"},we={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},de=["onDragover","onDragleave","onDrop"],ce=["onClick","title"],fe={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},pe={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},ve=["title","onClick"],ge=["onClick"],_e={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mt-1"},me={key:0},ye=["onClick"],he=["onClick"],be=["onClick"],xe={key:1},ke=["onClick"],$e={class:"tw-mt-3"},Ce={class:"tw-w-12 tw-text-right tw-text-sm tw-font-medium tw-text-gray-600"},Se=["onDragover","onDragleave","onDrop"],Ee=["onClick","title"],Oe={class:"tw-truncate tw-flex-1 tw-overflow-hidden tw-text-ellipsis tw-whitespace-nowrap tw-block"},Ae={key:0,class:"tw-flex tw-items-center tw-flex-shrink-0 tw-ml-2"},Ue=["title","onClick"],Me=["onClick"],Te={key:0,class:"tw-absolute tw-top-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mt-1"},Re={key:0},We=["onClick"],je=["onClick"],Ne=["onClick"],Le={key:1},Pe=["onClick"],Be={key:0,class:"tw-mt-4 tw-pt-3 tw-border-t"},ze={class:"tw-space-y-1 tw-text-sm"},Je={key:0,class:"tw-text-gray-400 tw-text-xs tw-text-center tw-py-2"},Ve=["onDragstart"],Fe=["onClick"],Ie={class:"tw-relative tw-mt-2"},qe=["onClick"],He={key:0,class:"tw-absolute tw-bottom-full tw-left-0 tw-w-full tw-bg-white tw-border tw-border-gray-300 tw-rounded-md tw-max-h-48 tw-overflow-y-auto tw-z-10 tw-shadow-lg tw-mb-1"},Ze={key:0},Ge=["onClick"],Ke={key:1},Qe=["onClick"],Xe=["onClick","disabled"],Ye={__name:"App",setup(G){const K=$t(()=>St(()=>import("./AddManualUserModal-C68F9x-8.js"),__vite__mapDeps([0,1]))),V=$t(()=>St(()=>import("./ReplyContentModal-BDcn3cye.js"),__vite__mapDeps([2,1]))),S=g([]),R=g({}),c=g({}),y=g(0),_=g(null),$=g(1),k=g([]),h=g(null),O=g({show:!1,message:"",type:"info"}),C=g(!1),j=g({}),P=g(!1),I=g({}),N=g(null),L=g(null),Q=g(!1),X=g(!1),W=g({show:!1,type:"",content:"",isConfirmed:!1,appointment:null,date:null,appointment:null,date:null,time:null,type:"consultation"}),Y=g(!0),rt=g(null),lt=J(()=>y.value===0?"æœ¬é€±é ç´„":y.value===1?"ä¸‹é€±é ç´„":y.value===-1?"ä¸Šé€±é ç´„":y.value>1?`æœªä¾†ç¬¬ ${y.value} é€±`:`éå»ç¬¬ ${Math.abs(y.value)} é€±`),Et=J(()=>{const t=new Map;return S.value.forEach(s=>{s&&s.id!==void 0&&s.id!==null&&t.set(s.id.toString(),s)}),t}),D=J(()=>{const t="ã„…ã„†ã„‡ã„ˆã„‰ã„Šã„‹ã„Œã„ã„ã„ã„ã„‘ã„’ã„“ã„”ã„•ã„–ã„—ã„˜ã„™ã„§ã„¨ã„©ã„šã„›ã„œã„ã„ã„Ÿã„ ã„¡ã„¢ã„£ã„¤ã„¥ã„¦#";return Object.keys(R.value).sort((s,e)=>s==="#"?1:e==="#"?-1:t.indexOf(s)-t.indexOf(e))}),tt=J(()=>{for(const t in c.value)if(q(c.value[t]))return!0;return!1}),Ot=J(()=>C.value?"ç™¼é€ä¸­...":P.value?"æœ¬é€±æé†’å·²ç™¼é€":tt.value?"ç™¼é€æ•´é€±æé†’":"æœ¬é€±ç„¡å¯æé†’å°è±¡"),At=J(()=>C.value?"tw-bg-gray-400 tw-text-white":tt.value?P.value?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700");function it(t){return L.value===t}function q(t){if(!t||t.is_closed)return!1;const s=e=>{if(!e)return!1;for(const n in e){const o=e[n];if(o.user_id){const w=Et.value.get(o.user_id.toString());if(w&&w.line_user_id&&w.line_user_id.startsWith("U"))return!0}}return!1};return s(t.appointments)||s(t.appointments_massage)}function Ut(t){const s=t.date_info.date;return j.value[s]?"ç™¼é€ä¸­...":I.value[s]?"æœ¬æ—¥æé†’å·²ç™¼é€":q(t)?`ğŸ“¤ ç™¼é€ ${t.date_info.day_name} æé†’`:"æœ¬æ—¥ç„¡å¯æé†’å°è±¡"}function Mt(t){const s=t.date_info.date;return j.value[s]?"tw-bg-gray-400 tw-text-white":q(t)?I.value[s]?"tw-bg-blue-600 tw-text-white":"tw-bg-white tw-text-gray-700 tw-border tw-border-gray-300 hover:tw-bg-gray-50":"tw-bg-red-200 tw-text-red-700"}const at=t=>{if(t.last_reply)return t.last_reply.confirmed?"ğŸŸ¢":"ğŸŸ¡";switch(t.reply_status){case"å·²ç¢ºèª":return"ğŸŸ¢";case"å·²å›è¦†":return"ğŸŸ¡";case"æœªå›è¦†":return"ğŸ”´";default:return"âšªï¸"}},ut=t=>{let s="æœªçŸ¥",e="ç„¡";if(t.last_reply){const n=t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—";s=t.last_reply.confirmed?"å·²ç¢ºèª":`æœ‰æ–°çš„${n}å›è¦† (é»æ“ŠæŸ¥çœ‹)`,e=t.last_reply.content||"N/A"}else t.reply_status&&(s=t.reply_status,e=t.last_reply||"ç„¡");return`é»æ“ŠæŸ¥çœ‹æˆ–è®Šæ›´ç‹€æ…‹
ç›®å‰: ${s}
å…§å®¹: ${e}`};function d(t,s="success",e=3e3){O.value={show:!0,message:t,type:s},setTimeout(()=>{O.value.show=!1},e)}function H(t){return t.reduce((e,n)=>{const o=n.zhuyin?n.zhuyin[0]:"#";return e[o]||(e[o]=[]),e[o].push(n),e},{})}async function wt(){Y.value=!0;try{const t=await U.get(`/api/admin/get_week_appointments?offset=${y.value}`);S.value=t.data.users||[],R.value=H(S.value),c.value=t.data.week_schedule||{},d("âœ… è³‡æ–™å·²æ›´æ–°","success")}catch(t){d("âŒ æ’ç¨‹è¼‰å…¥å¤±æ•—","error"),console.error("Schedule loading error:",t)}finally{Y.value=!1}}async function Tt(){try{const s=(await U.get(`/api/admin/get_week_appointments?offset=${y.value}`)).data,e=s.week_schedule||{},n=s.users||[];JSON.stringify(S.value)!==JSON.stringify(n)&&(S.value=n,R.value=H(S.value));for(const o in c.value){const w=c.value[o],r=e[o];if(w&&r){const v=(E,u)=>{if(!E)return;new Set([...Object.keys(E),...Object.keys(u||{})]).forEach(x=>{const z=E[x],Z=u?u[x]:null;Z&&JSON.stringify(z)!==JSON.stringify(Z)?E[x]={...Z}:!Z&&z&&z.user_id&&(E[x]={id:z.id,user_id:null,user_name:null,reply_status:"æœªå›è¦†",last_reply:null})})};v(w.appointments,r.appointments),w.appointments_massage||(w.appointments_massage={}),v(w.appointments_massage,r.appointments_massage),JSON.stringify(w.waiting_list)!==JSON.stringify(r.waiting_list)&&(w.waiting_list=r.waiting_list)}}console.log("Polling update complete at",new Date().toLocaleTimeString())}catch(t){console.error("Polling for updates failed:",t)}}async function dt(){d("è¼‰å…¥ä¸­...","info"),await wt()}function ct(t){y.value+=t,P.value=!1,I.value={},wt()}function F(){_.value=null,$.value=1,k.value=[]}function ft(t,s,e,n="consultation"){const o=`${t}-${s}-${n}`;if(_.value===o)F(),h.value=null;else if(_.value=o,$.value=1,h.value=null,e>0){const w=c.value[t],r=n==="massage"?w.appointments_massage:w.appointments;if(w&&r){const E=Object.keys(r)[e-1],u=r[E];u&&u.user_id&&(h.value={id:u.user_id,name:u.user_name})}}}function Rt(t){const s=`waiting-${t}`;_.value===s?F():(_.value=s,$.value=1)}function et(t){k.value=R.value[t]||[],$.value=2}async function B(t,s,e,n,o=null,w="consultation"){const r=w==="massage"?c.value[t]?.appointments_massage:c.value[t]?.appointments,v=r?.[s]?.user_id,E=r?.[s]?.user_name;if(F(),c.value[t]&&r?.[s]){const u=r[s];u.user_id=e,u.user_name=n,!v&&e?(u.id=Date.now(),u.reply_status="æœªå›è¦†"):v&&!e&&(u.id=null,u.reply_status="æœªå›è¦†",u.last_reply="")}d("å„²å­˜ä¸­...","info");try{const u=await U.post("/api/admin/save_appointment",{date:t,time:s,user_id:e,user_name:n,waiting_list_item_id:typeof o=="number"?o:null,type:w});if(u.data.status==="success"){d("âœ… é ç´„å·²å„²å­˜","success");const b=u.data.appointment;if(b&&c.value[t]&&r?.[s]){const x=r[s];x.id=b.id,x.reply_status=b.reply_status,x.last_reply=b.last_reply,o&&(S.value=S.value.filter(z=>z.id!==e),R.value=H(S.value))}return!0}else throw new Error(u.data.message||"å„²å­˜å¤±æ•—")}catch(u){return d(`âŒ å„²å­˜å¤±æ•—: ${u.message||"æœªçŸ¥éŒ¯èª¤"}`,"error"),c.value[t]&&r?.[s]&&(r[s].user_id=v,r[s].user_name=E),!1}}async function Wt(t,s){F(),d("æ–°å¢å‚™å–ä¸­...","info");try{const e=await U.post("/api/admin/waiting_list",{date:t,user_id:s.id,user_name:s.name});if(e.data.status==="success")c.value[t].waiting_list||(c.value[t].waiting_list=[]),c.value[t].waiting_list.push(e.data.item),d("âœ… å·²æ–°å¢è‡³å‚™å–","success");else throw new Error(e.data.message||"æ–°å¢å¤±æ•—")}catch(e){d(`âŒ æ–°å¢å‚™å–å¤±æ•—: ${e.message}`,"error")}}async function jt(t,s){if(confirm("ç¢ºå®šè¦å¾å‚™å–åå–®ä¸­ç§»é™¤å—ï¼Ÿ"))try{await U.delete(`/api/admin/waiting_list/${t}`);const e=c.value[s];e&&e.waiting_list&&(e.waiting_list=e.waiting_list.filter(n=>n.id!==t)),d("âœ… å·²å¾å‚™å–ç§»é™¤","success")}catch{d("âŒ ç§»é™¤å¤±æ•—","error")}}function st(t,s,e,n="consultation"){_.value.startsWith("waiting-")?Wt(t,e):B(t,s,e.id,e.name,null,n)}function Nt(t,s){N.value=s,t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify(s))}function Lt(){setTimeout(()=>{N.value=null,L.value=null},50)}function pt(t,s,e,n="consultation"){N.value&&!e.user_id&&(L.value=`${t}-${s}-${n}`)}function vt(t,s,e="consultation"){L.value===`${t}-${s}-${e}`&&(L.value=null)}async function gt(t,s,e="consultation"){if(N.value&&L.value===`${t}-${s}-${e}`){const n={...N.value};L.value=null,await B(t,s,n.user_id,n.user_name,n.id,e)&&(c.value[t].waiting_list=c.value[t].waiting_list.filter(w=>w.id!==n.id))}}async function Pt(){const t=Object.keys(c.value).sort();let s="";if(t.length>0){const e=c.value[t[0]].date_info.display,n=c.value[t[t.length-1]].date_info.display;s=` (${e} ~ ${n})`}if(confirm(`ç¢ºå®šè¦ç™¼é€ã€Œ${lt.value}ã€${s} çš„é ç´„æé†’å—ï¼Ÿ`)){C.value=!0;try{const n=(await U.post("/api/admin/send_appointment_reminders",{type:"week",offset:y.value})).data;d(`âœ… å·²ç™¼é€ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`),n.sent_count>0&&(P.value=!0)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{C.value=!1}}}async function Bt(t,s){if(confirm(`ç¢ºå®šè¦ç™¼é€ ${s} çš„é ç´„æé†’å—ï¼Ÿ`)){j.value[t]=!0;try{const n=(await U.post("/api/admin/send_appointment_reminders",{type:"day",date:t})).data;n.sent_count>0&&(I.value[t]=!0),d(`âœ… å·²ç™¼é€ ${s} çš„ ${n.sent_count} å‰‡æé†’${n.failed_count>0?`ï¼Œ${n.failed_count} å‰‡å¤±æ•—`:""}`)}catch{d("âŒ ç™¼é€å¤±æ•—","error")}finally{j.value[t]=!1}}}function zt(){const{appointment:t,date:s,time:e,type:n}=W.value;_t(t,s,e,n,"æœªå›è¦†"),nt()}async function _t(t,s,e,n="consultation",o=null){const w=c.value[s],r=n==="massage"?w.appointments_massage:w.appointments,v=Object.values(r),E=v.filter(b=>b.id!==t.id&&b.user_id===t.user_id);if(E.length>0&&(t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†")&&confirm(`ã€Œ${t.user_name}ã€åœ¨ ${s} é‚„æœ‰å…¶ä»– ${E.length} å€‹é ç´„ï¼Œè¦å°‡ç•¶æ—¥æ‰€æœ‰é ç´„ä¸€ä½µæ¨™ç¤ºç‚ºã€Œå·²ç¢ºèªã€å—ï¼Ÿ`)){d("æ‰¹æ¬¡ç¢ºèªä¸­...","info");try{const b=await U.post("/api/admin/confirm_user_day_replies",{user_id:t.user_id,date:s});if(b.data.status==="success")v.forEach(x=>{x.user_id===t.user_id&&(x.reply_status="å·²ç¢ºèª")}),d("âœ… å·²æ‰¹æ¬¡ç¢ºèªå®Œç•¢","success");else throw new Error(b.data.message||"æ‰¹æ¬¡ç¢ºèªå¤±æ•—")}catch(b){d(`âŒ æ‰¹æ¬¡ç¢ºèªå¤±æ•—: ${b.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}return}let u;o?u=o:t.reply_status==="æœªå›è¦†"||t.reply_status==="å·²å›è¦†"?u="å·²ç¢ºèª":u="æœªå›è¦†",d("æ›´æ–°ç‹€æ…‹ä¸­...","info");try{const b=await U.put(`/api/admin/appointments/${t.id}/reply_status`,{status:u});if(b.data.status==="success"){const x=r[e];x&&(x.reply_status=u,u==="å·²ç¢ºèª"&&x.last_reply?x.last_reply.confirmed=!0:u==="æœªå›è¦†"&&(x.last_reply=null)),d(`âœ… ç‹€æ…‹å·²æ›´æ–°ç‚ºã€Œ${u}ã€`,"success")}else throw new Error(b.data.message||"æ›´æ–°å¤±æ•—")}catch(b){d(`âŒ æ›´æ–°ç‹€æ…‹å¤±æ•—: ${b.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function nt(){W.value.show=!1}function Jt(){const{appointment:t,date:s,time:e,type:n}=W.value;t&&t.id&&ot(t.id,s,e,n),nt()}function Vt(t,s,e,n="consultation"){t.last_reply&&(W.value={show:!0,type:t.last_reply.type==="image"?"åœ–ç‰‡":"æ–‡å­—",content:t.last_reply.content,isConfirmed:t.last_reply.confirmed,appointment:t,date:s,time:e,type:n})}function mt(t,s,e,n="consultation"){t.last_reply&&!t.last_reply.confirmed?Vt(t,s,e,n):_t(t,s,e,n)}async function ot(t,s,e,n="consultation"){d("ç¢ºèªä¸­...","info");try{const o=await U.post(`/api/admin/appointments/${t}/confirm_reply`);if(o.data.status==="success"){const w=c.value[s],v=(n==="massage"?w.appointments_massage:w.appointments)?.[e];v&&(v.reply_status="å·²ç¢ºèª",v.last_reply&&typeof v.last_reply=="object"&&(v.last_reply.confirmed=!0)),d("âœ… å·²ç¢ºèªå›è¦†","success")}else throw new Error(o.data.message||"ç¢ºèªå¤±æ•—")}catch(o){d(`âŒ ç¢ºèªå¤±æ•—: ${o.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}}function Ft(){Q.value=!0}function yt(){Q.value=!1}async function It(){if(!arguments[0]){d("ç”¨æˆ¶å§“åä¸èƒ½ç‚ºç©ºã€‚","error");return}X.value=!0;try{const t=await U.post("/api/admin/users/add_manual",{name:arguments[0]});if(t.data.status==="success"){const s=t.data.user;S.value.push(s),R.value=H(S.value),d(`âœ… è‡¨æ™‚ç”¨æˆ¶ "${s.name}" å·²æ–°å¢ã€‚`,"success"),yt()}else throw new Error(t.data.message||"æ–°å¢å¤±æ•—")}catch(t){d(`âŒ æ–°å¢è‡¨æ™‚ç”¨æˆ¶å¤±æ•—: ${t.message||"æœªçŸ¥éŒ¯èª¤"}`,"error")}finally{X.value=!1}}const ht=t=>{const s=t.target.closest(".tw-relative"),e=t.target.closest('[draggable="true"]');!s&&!e&&F()};return qt(()=>{dt(),rt.value=setInterval(Tt,15e3),document.addEventListener("click",ht)}),Ht(()=>{clearInterval(rt.value),document.removeEventListener("click",ht)}),(t,s)=>(i(),l("div",Xt,[a("div",Yt,[a("div",Dt,[a("h2",te,f(lt.value),1)]),a("div",ee,[a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[0]||(s[0]=e=>ct(-1))},"â¬…ï¸ ä¸Šä¸€é€±"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:s[1]||(s[1]=e=>ct(1))},"ä¸‹ä¸€é€± â¡ï¸"),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-indigo-600 tw-text-white hover:tw-bg-indigo-700",onClick:dt},"ğŸ”„ é‡æ–°è¼‰å…¥"),a("button",{class:M(["tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",At.value]),onClick:Pt,disabled:C.value||!tt.value},"ğŸ“¨ "+f(Ot.value),11,se),a("button",{class:"tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition tw-bg-green-600 tw-text-white hover:tw-bg-green-700",onClick:Ft},"â• æ–°å¢è‡¨æ™‚ç”¨æˆ¶")]),s[5]||(s[5]=Zt('<div class="tw-text-center tw-mt-3 tw-text-xs tw-text-gray-500 tw-space-y-1"><div>æé†’æŒ‰éˆ•ï¼š<span class="tw-font-semibold tw-text-gray-700">ç™½è‰²</span>=å¯ç™¼é€, <span class="tw-font-semibold tw-text-blue-600">è—è‰²</span>=å·²ç™¼é€, <span class="tw-font-semibold tw-text-red-600">ç´…è‰²</span>=ç„¡å¯æé†’å°è±¡</div><div>é ç´„æ™‚æ®µï¼š<span class="tw-px-1 tw-py-0.5 tw-rounded tw-bg-red-200 tw-text-red-800 tw-font-semibold">ç´…è‰²åº•</span> = è‡¨æ™‚ç”¨æˆ¶ (ç„¡æ³•ç™¼é€LINEæé†’)</div><div class="tw-pt-1">ç‹€æ…‹ç‡ˆè™Ÿèªªæ˜ï¼š<span class="tw-font-mono">ğŸ”´</span>=æœªå›è¦†, <span class="tw-font-mono">ğŸŸ¡</span>=å·²å›è¦†(ç³»çµ±è‡ªå‹•æ¨™è¨˜), <span class="tw-font-mono">ğŸŸ¢</span>=å·²ç¢ºèª(æ‰‹å‹•æ¨™è¨˜)ã€‚é»æ“Šç‡ˆè™Ÿå¯æ‰‹å‹•åˆ‡æ›ç‹€æ…‹ã€‚</div></div>',1))]),Y.value?(i(),l("div",ne,[...s[6]||(s[6]=[a("div",{class:"tw-animate-spin tw-rounded-full tw-h-12 tw-w-12 tw-border-b-2 tw-border-indigo-500"},null,-1),a("p",{class:"tw-ml-4 tw-text-gray-600"},"è¼‰å…¥ä¸­...",-1)])])):(i(),l("div",oe,[(i(!0),l(A,null,T(c.value,e=>(i(),l("div",{key:e.date_info.date,class:M(["tw-rounded-lg tw-p-3 tw-shadow-lg tw-flex tw-flex-col tw-gap-y-3",e.is_closed?"tw-bg-gray-100":"tw-bg-white"])},[a("div",{class:M(["tw-text-white tw-p-2.5 tw-rounded-md tw-text-center",e.is_closed?"tw-bg-gray-400":"tw-bg-gradient-to-r tw-from-indigo-600 tw-to-purple-700"])},[a("h3",re,f(e.date_info.day_name),1),a("p",le,f(e.date_info.display),1)],2),a("div",ie,[e.is_closed?(i(),l("div",ae,[...s[7]||(s[7]=[xt(" ğŸ˜´",-1),a("br",null,null,-1),xt("æœ¬æ—¥ä¼‘è¨º ",-1)])])):(i(),l(A,{key:1},[a("div",ue,[s[9]||(s[9]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"çœ‹è¨ºæ™‚æ®µ",-1)),(i(!0),l(A,null,T(e.appointments,(n,o,w)=>(i(),l("div",{key:"consultation-"+o,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",we,f(o),1),a("div",{class:M(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":it(`${e.date_info.date}-${o}-consultation`)}]),onDragover:p(r=>pt(e.date_info.date,o,n,"consultation"),["prevent"]),onDragleave:r=>vt(e.date_info.date,o,"consultation"),onDrop:p(r=>gt(e.date_info.date,o,"consultation"),["prevent"])},[a("div",{class:M(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:r=>ft(e.date_info.date,o,w,"consultation"),title:n.user_name||"æœªé ç´„"},[a("span",fe,f(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",pe,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:ut(n),onClick:p(r=>mt(n,e.date_info.date,o,"consultation"),["stop"])},f(at(n)),9,ve),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:p(r=>ot(n.id,e.date_info.date,o,"consultation"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,ge)):m("",!0)])):m("",!0),s[8]||(s[8]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,ce),_.value===`${e.date_info.date}-${o}-consultation`?(i(),l("div",_e,[$.value===1?(i(),l("div",me,[h.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:p(r=>B(e.date_info.date,o,h.value.id,h.value.name,null,"consultation"),["stop"])}," â¡ï¸ åŒä¸Š ("+f(h.value.name)+") ",9,ye)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(r=>B(e.date_info.date,o,"","-- æœªé ç´„ --",null,"consultation"),["stop"])},"-- æœªé ç´„ --",8,he),(i(!0),l(A,null,T(D.value,r=>(i(),l("div",{key:r,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(v=>et(r),["stop"])},f(r),9,be))),128))])):m("",!0),$.value===2?(i(),l("div",xe,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[2]||(s[2]=p(r=>$.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(A,null,T(k.value,r=>(i(),l("div",{key:r.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(v=>st(e.date_info.date,o,r,"consultation"),["stop"])},f(r.name),9,ke))),128))])):m("",!0)])):m("",!0)],42,de)]))),128))]),a("div",$e,[s[11]||(s[11]=a("div",{class:"tw-text-xs tw-font-bold tw-text-gray-500 tw-mb-1 tw-border-b tw-pb-1"},"æ¨æ‹¿æ™‚æ®µ",-1)),(i(!0),l(A,null,T(e.appointments_massage,(n,o,w)=>(i(),l("div",{key:"massage-"+o,class:"tw-flex tw-items-center tw-gap-2 tw-mb-1"},[a("span",Ce,f(o),1),a("div",{class:M(["tw-relative tw-flex-1",{"tw-bg-green-100 tw-border-2 tw-border-dashed tw-border-green-400":it(`${e.date_info.date}-${o}-massage`)}]),onDragover:p(r=>pt(e.date_info.date,o,n,"massage"),["prevent"]),onDragleave:r=>vt(e.date_info.date,o,"massage"),onDrop:p(r=>gt(e.date_info.date,o,"massage"),["prevent"])},[a("div",{class:M(["tw-w-full tw-p-1.5 tw-border tw-text-sm tw-rounded tw-cursor-pointer tw-flex tw-justify-between tw-items-center tw-min-w-0",{"tw-text-gray-500":!n.user_id,"tw-bg-red-200 tw-border-red-400 tw-text-red-800":n.user_id?.startsWith("manual_"),"tw-bg-white tw-border-gray-300 tw-text-gray-800":!n.user_id?.startsWith("manual_"),"tw-font-semibold":n.user_id&&n.user_id.startsWith("manual_")}]),onClick:r=>ft(e.date_info.date,o,w,"massage"),title:n.user_name||"æœªé ç´„"},[a("span",Oe,f(n.user_name||"-- æœªé ç´„ --"),1),n.id?(i(),l("div",Ae,[a("span",{class:"tw-text-xs tw-font-mono tw-cursor-pointer",title:ut(n),onClick:p(r=>mt(n,e.date_info.date,o,"massage"),["stop"])},f(at(n)),9,Ue),n.reply_status==="å·²å›è¦†"?(i(),l("button",{key:0,onClick:p(r=>ot(n.id,e.date_info.date,o,"massage"),["stop"]),title:"ç¢ºèªå›è¦†",class:"tw-ml-1 tw-px-1.5 tw-py-0.5 tw-text-xs tw-bg-green-500 tw-text-white tw-rounded hover:tw-bg-green-600"}," âœ… ",8,Me)):m("",!0)])):m("",!0),s[10]||(s[10]=a("span",{class:"tw-ml-2 tw-text-gray-400 tw-text-xs"},"â–¼",-1))],10,Ee),_.value===`${e.date_info.date}-${o}-massage`?(i(),l("div",Te,[$.value===1?(i(),l("div",Re,[h.value?(i(),l("div",{key:0,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-blue-600 tw-font-bold tw-border-b hover:tw-bg-gray-100",onClick:p(r=>B(e.date_info.date,o,h.value.id,h.value.name,null,"massage"),["stop"])}," â¡ï¸ åŒä¸Š ("+f(h.value.name)+") ",9,We)):m("",!0),a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(r=>B(e.date_info.date,o,"","-- æœªé ç´„ --",null,"massage"),["stop"])},"-- æœªé ç´„ --",8,je),(i(!0),l(A,null,T(D.value,r=>(i(),l("div",{key:r,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(v=>et(r),["stop"])},f(r),9,Ne))),128))])):m("",!0),$.value===2?(i(),l("div",Le,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[3]||(s[3]=p(r=>$.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(A,null,T(k.value,r=>(i(),l("div",{key:r.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(v=>st(e.date_info.date,o,r,"massage"),["stop"])},f(r.name),9,Pe))),128))])):m("",!0)])):m("",!0)],42,Se)]))),128))])],64))]),e.is_closed?m("",!0):(i(),l("div",Be,[s[12]||(s[12]=a("h4",{class:"tw-text-sm tw-font-semibold tw-text-gray-500 tw-mb-2"},"å‚™å–åå–®",-1)),a("div",ze,[!e.waiting_list||e.waiting_list.length===0?(i(),l("div",Je,"å°šç„¡å‚™å–")):m("",!0),(i(!0),l(A,null,T(e.waiting_list,n=>(i(),l("div",{key:n.id,class:M(["tw-flex tw-items-center tw-justify-between tw-p-1.5 tw-bg-yellow-50 tw-border tw-border-yellow-200 tw-rounded tw-cursor-grab tw-transition-opacity",{"tw-opacity-40":N.value&&N.value.id===n.id}]),draggable:"true",onDragstart:o=>Nt(o,n),onDragend:Lt},[a("span",null,f(n.user_name),1),a("button",{onClick:o=>jt(n.id,e.date_info.date),class:"tw-text-red-500 hover:tw-text-red-700 tw-text-xs"},"âœ•",8,Fe)],42,Ve))),128))]),a("div",Ie,[a("button",{onClick:n=>Rt(e.date_info.date),class:"tw-w-full tw-text-xs tw-text-center tw-py-1.5 tw-bg-gray-100 hover:tw-bg-gray-200 tw-rounded-md tw-text-gray-600"},"+ æ–°å¢å‚™å–",8,qe),_.value===`waiting-${e.date_info.date}`?(i(),l("div",He,[$.value===1?(i(),l("div",Ze,[(i(!0),l(A,null,T(D.value,n=>(i(),l("div",{key:n,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(o=>et(n),["stop"])},f(n),9,Ge))),128))])):m("",!0),$.value===2?(i(),l("div",Ke,[a("div",{class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-font-bold tw-border-b tw-text-purple-700 hover:tw-bg-gray-100",onClick:s[4]||(s[4]=p(n=>$.value=1,["stop"]))},"â† è¿”å›æ³¨éŸ³"),(i(!0),l(A,null,T(k.value,n=>(i(),l("div",{key:n.id,class:"tw-px-2.5 tw-py-2 tw-cursor-pointer tw-text-sm tw-text-gray-800 hover:tw-bg-gray-100",onClick:p(o=>st(e.date_info.date,null,n),["stop"])},f(n.name),9,Qe))),128))])):m("",!0)])):m("",!0)])])),e.is_closed?m("",!0):(i(),l("button",{key:1,class:M(["tw-mt-2 tw-w-full tw-px-4 tw-py-2 tw-rounded-md tw-text-sm tw-font-medium tw-transition disabled:tw-cursor-not-allowed",Mt(e)]),onClick:n=>Bt(e.date_info.date,e.date_info.day_name),disabled:j.value[e.date_info.date]||!q(e)},f(Ut(e)),11,Xe))],2))),128))])),O.value.show?(i(),l("div",{key:2,class:M(["tw-fixed tw-top-5 tw-right-5 tw-px-5 tw-py-4 tw-rounded-md tw-shadow-lg tw-text-white",O.value.type==="success"?"tw-bg-gray-800":"tw-bg-red-700"])},f(O.value.message),3)):m("",!0),bt(kt(K),{show:Q.value,"is-adding":X.value,onClose:yt,onSubmit:It},null,8,["show","is-adding"]),bt(kt(V),{show:W.value.show,type:W.value.type,content:W.value.content,"is-confirmed":W.value.isConfirmed,onClose:nt,onConfirm:Jt,onResetStatus:zt},null,8,["show","type","content","is-confirmed"])]))}};Gt(Ye).mount("#app");
